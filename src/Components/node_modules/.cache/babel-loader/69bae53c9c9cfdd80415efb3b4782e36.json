{"ast":null,"code":"/** \n * Copyright (c) INOVUA SOFTWARE TECHNOLOGIES.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.isLivePagination = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = require(\"react\");\n\nvar _clamp = _interopRequireDefault(require(\"../../utils/clamp\"));\n\nvar _getIndexBy = _interopRequireDefault(require(\"../../utils/getIndexBy\"));\n\nvar _fastDeepEqual = _interopRequireDefault(require(\"fast-deep-equal\"));\n\nvar _useLoadDataEffect = _interopRequireDefault(require(\"../useLoadDataEffect\"));\n\nvar _useProperty7 = _interopRequireDefault(require(\"../useProperty\"));\n\nvar _useNamedState9 = _interopRequireDefault(require(\"../useNamedState\"));\n\nvar _computeData = _interopRequireDefault(require(\"./computeData\"));\n\nvar _batchUpdate = _interopRequireDefault(require(\"../../utils/batchUpdate\"));\n\nvar _usePrevious = _interopRequireDefault(require(\"../usePrevious\"));\n\nvar _isControlledProperty = _interopRequireDefault(require(\"../../utils/isControlledProperty\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2.default)(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar raf = global.requestAnimationFrame;\n\nvar isRemoteData = function isRemoteData(props) {\n  if (props.dataSource == null) {\n    return false;\n  }\n\n  return typeof props.dataSource.then === 'function' || typeof props.dataSource === 'function';\n};\n\nvar isRemoteSort = function isRemoteSort(props) {\n  var remoteSort = props.remoteSort;\n  return remoteSort === true || remoteSort === undefined && isRemoteData(props);\n};\n\nvar isRemoteFilter = function isRemoteFilter(props) {\n  var remoteFilter = props.remoteFilter;\n  return remoteFilter === true || remoteFilter === undefined && isRemoteData(props);\n};\n\nvar isPagination = function isPagination(props) {\n  return !!props.pagination;\n};\n\nvar isLocalPagination = function isLocalPagination(props) {\n  return isPagination(props) && !isRemotePagination(props);\n};\n\nvar isLivePagination = function isLivePagination(props) {\n  return !!props.livePagination && isRemotePagination(props);\n};\n\nexports.isLivePagination = isLivePagination;\n\nvar isRemotePagination = function isRemotePagination(props) {\n  var remotePagination = props.remotePagination,\n      pagination = props.pagination,\n      livePagination = props.livePagination;\n\n  if (pagination === false || pagination === 'local') {\n    return false;\n  }\n\n  if (pagination === 'remote' || isRemoteData(props)) {\n    return true;\n  }\n\n  if (remotePagination !== undefined) {\n    return remotePagination;\n  }\n\n  return !!livePagination;\n};\n\nvar loadDataSource = function loadDataSource(dataSource, _ref) {\n  var skip = _ref.skip,\n      limit = _ref.limit,\n      sortInfo = _ref.sortInfo,\n      filterValue = _ref.filterValue,\n      groupBy = _ref.groupBy;\n\n  if (typeof dataSource === 'function') {\n    dataSource = loadDataSource(dataSource({\n      skip: skip,\n      limit: limit,\n      sortInfo: sortInfo,\n      filterValue: filterValue,\n      groupBy: groupBy\n    }), {\n      skip: skip,\n      limit: limit,\n      sortInfo: sortInfo,\n      groupBy: groupBy,\n      filterValue: filterValue\n    });\n  }\n\n  if (dataSource instanceof Promise) {\n    return dataSource.then(function (result) {\n      if (Array.isArray(result)) {\n        return {\n          data: result,\n          count: result.length\n        };\n      }\n\n      return {\n        data: result.data,\n        count: result.count\n      };\n    });\n  }\n\n  return Promise.resolve({\n    data: dataSource,\n    count: dataSource.length\n  });\n};\n\nvar useData = function useData(_ref2, context) {\n  var dataSource = _ref2.dataSource,\n      skip = _ref2.skip,\n      limit = _ref2.limit,\n      localPagination = _ref2.localPagination;\n  var data;\n  var silentSetData;\n\n  var _useNamedState = (0, _useNamedState9.default)([], context, 'data');\n\n  var _useNamedState2 = (0, _slicedToArray2.default)(_useNamedState, 2);\n\n  data = _useNamedState2[0];\n  silentSetData = _useNamedState2[1];\n\n  var _useState = (0, _react.useState)(null),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      dataMap = _useState2[0],\n      setDataMap = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(null),\n      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n      dataIndexMap = _useState4[0],\n      setDataIndexMap = _useState4[1];\n\n  var originalData;\n  var setOriginalData;\n\n  var _useNamedState3 = (0, _useNamedState9.default)(Array.isArray(dataSource) ? dataSource : [], context, 'originalData');\n\n  var _useNamedState4 = (0, _slicedToArray2.default)(_useNamedState3, 2);\n\n  originalData = _useNamedState4[0];\n  setOriginalData = _useNamedState4[1];\n\n  var _useNamedState5 = (0, _useNamedState9.default)(data.length, context, 'count'),\n      _useNamedState6 = (0, _slicedToArray2.default)(_useNamedState5, 2),\n      count = _useNamedState6[0],\n      setCount = _useNamedState6[1];\n\n  var _useNamedState7 = (0, _useNamedState9.default)(0, context, 'dataCountAfterFilter'),\n      _useNamedState8 = (0, _slicedToArray2.default)(_useNamedState7, 2),\n      dataCountAfterFilter = _useNamedState8[0],\n      setDataCountAfterFilter = _useNamedState8[1];\n\n  return {\n    setDataMap: setDataMap,\n    dataMap: dataMap,\n    dataIndexMap: dataIndexMap,\n    setDataIndexMap: setDataIndexMap,\n    originalData: originalData,\n    setOriginalData: setOriginalData,\n    data: data,\n    count: count,\n    dataCountAfterFilter: dataCountAfterFilter,\n    silentSetData: silentSetData,\n    setDataCountAfterFilter: setDataCountAfterFilter,\n    setCount: setCount\n  };\n};\n\nvar getDataCountForPagination = function getDataCountForPagination(props) {\n  var paginationCount = props.remotePagination ? props.count : props.dataCountAfterFilter != null ? props.dataCountAfterFilter : props.originalData.length;\n  return paginationCount;\n};\n\nvar getCurrentPage = function getCurrentPage(props) {\n  return Math.floor(props.skip / props.limit) + 1;\n};\n\nvar getPageCount = function getPageCount(_ref3) {\n  var count = _ref3.count,\n      limit = _ref3.limit;\n  return Math.ceil(count / limit);\n};\n\nvar getSkipForPage = function getSkipForPage(_ref4) {\n  var page = _ref4.page,\n      limit = _ref4.limit;\n  return Math.max(0, limit * (page - 1));\n};\n\nvar hasNextPage = function hasNextPage(_ref5) {\n  var skip = _ref5.skip,\n      limit = _ref5.limit,\n      count = _ref5.count;\n  return getCurrentPage({\n    skip: skip,\n    limit: limit\n  }) < getPageCount({\n    count: count,\n    limit: limit\n  });\n};\n\nvar hasPrevPage = function hasPrevPage(_ref6) {\n  var skip = _ref6.skip,\n      limit = _ref6.limit,\n      count = _ref6.count;\n  var currentPage = getCurrentPage({\n    skip: skip,\n    limit: limit\n  });\n  return currentPage > 1 && currentPage - 1 < getPageCount({\n    count: count,\n    limit: limit\n  });\n};\n\nvar usePagination = function usePagination(_ref7, computedPropsRef) {\n  var append = _ref7.append,\n      reload = _ref7.reload,\n      setAppend = _ref7.setAppend,\n      skip = _ref7.skip,\n      limit = _ref7.limit,\n      count = _ref7.count,\n      silentSetSkip = _ref7.setSkip,\n      silentSetLimit = _ref7.setLimit,\n      remotePagination = _ref7.remotePagination,\n      localPagination = _ref7.localPagination,\n      pagination = _ref7.pagination,\n      lastSkipRef = _ref7.lastSkipRef,\n      lastLimitRef = _ref7.lastLimitRef,\n      dataCountAfterFilter = _ref7.dataCountAfterFilter,\n      livePagination = _ref7.livePagination,\n      originalData = _ref7.originalData,\n      data = _ref7.data;\n  var paginationCount = getDataCountForPagination({\n    originalData: originalData,\n    remotePagination: remotePagination,\n    count: count,\n    dataCountAfterFilter: dataCountAfterFilter\n  });\n\n  var setLimitOrSkip = function setLimitOrSkip(computedProps, config, queue) {\n    return (0, _computeData.default)(_objectSpread(_objectSpread({\n      skip: skip,\n      limit: limit\n    }, config), {}, {\n      localPagination: localPagination\n    }), computedProps, queue);\n  };\n\n  var setSkip = function setSkip(skip, config) {\n    var computedProps = computedPropsRef.current;\n    var queue = (0, _batchUpdate.default)();\n    var computedRemoteData = computedProps.computedRemoteData;\n    queue.commit(function () {\n      if (config && config.append !== undefined) {\n        setAppend(config.append);\n      }\n\n      if (computedRemoteData) {\n        computedProps.setLoadDataTrigger(function (loadDataTrigger) {\n          return [].concat((0, _toConsumableArray2.default)(loadDataTrigger), ['skip']);\n        });\n      }\n\n      silentSetSkip(skip);\n    });\n  };\n\n  var setLimit = function setLimit(limit) {\n    var computedProps = computedPropsRef.current;\n    var queue = (0, _batchUpdate.default)();\n    var computedRemoteData = computedProps.computedRemoteData;\n    queue.commit(function () {\n      if (computedRemoteData) {\n        computedProps.setLoadDataTrigger(function (loadDataTrigger) {\n          return [].concat((0, _toConsumableArray2.default)(loadDataTrigger), ['limit']);\n        });\n      }\n\n      silentSetLimit(limit);\n    });\n  };\n\n  var incrementSkip = function incrementSkip(amount, config) {\n    setSkip(skip + amount, config);\n  };\n\n  var gotoNextPage = function gotoNextPage(config) {\n    if (hasNextPage({\n      skip: skip,\n      limit: lastLimitRef.current,\n      count: paginationCount\n    })) {\n      incrementSkip(lastLimitRef.current, config);\n    }\n  };\n\n  var gotoPrevPage = function gotoPrevPage() {\n    if (hasPrevPage({\n      skip: skip,\n      limit: limit,\n      count: paginationCount\n    })) {\n      incrementSkip(-limit);\n    }\n  };\n\n  var gotoPage = function gotoPage(page, config) {\n    page = (0, _clamp.default)(page, 1, getPageCount({\n      count: paginationCount,\n      limit: limit\n    }));\n    var force = config ? config.force : false;\n\n    if (page === getCurrentPage({\n      skip: skip,\n      limit: limit\n    }) && !force) {\n      return;\n    }\n\n    setSkip(getSkipForPage({\n      page: page,\n      limit: limit\n    }));\n  };\n\n  var hasNext = function hasNext() {\n    return hasNextPage({\n      skip: skip,\n      limit: limit,\n      count: paginationCount\n    });\n  };\n\n  var hasPrev = function hasPrev() {\n    return hasPrevPage({\n      skip: skip,\n      limit: limit,\n      count: paginationCount\n    });\n  };\n\n  var gotoFirstPage = function gotoFirstPage() {\n    return gotoPage(1);\n  };\n\n  var gotoLastPage = function gotoLastPage() {\n    return gotoPage(getPageCount({\n      count: paginationCount,\n      limit: limit\n    }));\n  };\n\n  var paginationProps;\n\n  if ((localPagination || remotePagination) && !livePagination) {\n    paginationProps = {\n      onSkipChange: setSkip,\n      onLimitChange: setLimit,\n      reload: reload,\n      onRefresh: reload,\n      totalCount: paginationCount,\n      count: count,\n      skip: skip,\n      limit: limit,\n      remotePagination: remotePagination,\n      localPagination: localPagination,\n      livePagination: livePagination,\n      pagination: pagination,\n      gotoNextPage: gotoNextPage,\n      gotoFirstPage: gotoFirstPage,\n      gotoLastPage: gotoLastPage,\n      gotoPrevPage: gotoPrevPage,\n      hasNextPage: hasNext,\n      hasPrevPage: hasPrev\n    };\n  }\n\n  return {\n    count: count,\n    paginationCount: paginationCount,\n    reload: reload,\n    setSkip: setSkip,\n    setLimit: setLimit,\n    gotoNextPage: gotoNextPage,\n    gotoPrevPage: gotoPrevPage,\n    hasNextPage: hasNext,\n    hasPrevPage: hasPrev,\n    gotoFirstPage: gotoFirstPage,\n    gotoLastPage: gotoLastPage,\n    paginationProps: paginationProps\n  };\n};\n\nvar useDataSourceCache = function useDataSourceCache(props, computedProps, computedPropsRef) {\n  var prevDataSource = (0, _usePrevious.default)(props.dataSource, props.dataSource);\n\n  var _useProperty = (0, _useProperty7.default)(props, 'dataSourceCache', undefined, {\n    onChange: function onChange(dataSourceCache, info) {\n      var computedProps = computedPropsRef.current;\n\n      if (!computedProps) {\n        return;\n      }\n\n      if (computedProps.initialProps.onDataSourceCacheChange) {\n        computedProps.initialProps.onDataSourceCacheChange(dataSourceCache, info);\n      }\n    }\n  }),\n      _useProperty2 = (0, _slicedToArray2.default)(_useProperty, 2),\n      dataSourceCache = _useProperty2[0],\n      setDataSourceCache = _useProperty2[1];\n\n  if (props.clearDataSourceCacheOnChange && prevDataSource !== props.dataSource) {\n    dataSourceCache = undefined;\n  }\n\n  (0, _react.useLayoutEffect)(function () {\n    if (props.clearDataSourceCacheOnChange) {\n      setDataSourceCache(undefined);\n    }\n  }, [props.dataSource]);\n  return [dataSourceCache, setDataSourceCache];\n};\n\nvar _default = function _default(props, computedProps, computedPropsRef) {\n  var computedRemoteData = isRemoteData(props);\n  var computedRemoteFilter = isRemoteFilter(props);\n  var computedRemoteSort = isRemoteSort(props);\n  var computedLivePagination = isLivePagination(props);\n  var computedRemotePagination = isRemotePagination(props);\n  var computedLocalPagination = isLocalPagination(props);\n  var computedPagination = computedRemotePagination || computedLocalPagination;\n\n  var _useState5 = (0, _react.useState)([]),\n      _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n      ungroupedData = _useState6[0],\n      setUngroupedData = _useState6[1];\n\n  var _useState7 = (0, _react.useState)([]),\n      _useState8 = (0, _slicedToArray2.default)(_useState7, 2),\n      loadDataTrigger = _useState8[0],\n      setLoadDataTrigger = _useState8[1];\n\n  var _useState9 = (0, _react.useState)(false),\n      _useState10 = (0, _slicedToArray2.default)(_useState9, 2),\n      append = _useState10[0],\n      setAppend = _useState10[1];\n\n  var _useProperty3 = (0, _useProperty7.default)(props, 'skip', 0),\n      _useProperty4 = (0, _slicedToArray2.default)(_useProperty3, 2),\n      computedSkip = _useProperty4[0],\n      setSkip = _useProperty4[1];\n\n  var _useProperty5 = (0, _useProperty7.default)(props, 'limit', 50),\n      _useProperty6 = (0, _slicedToArray2.default)(_useProperty5, 2),\n      computedLimit = _useProperty6[0],\n      setLimit = _useProperty6[1];\n\n  var _useDataSourceCache = useDataSourceCache(props, computedProps, computedPropsRef),\n      _useDataSourceCache2 = (0, _slicedToArray2.default)(_useDataSourceCache, 2),\n      computedDataSourceCache = _useDataSourceCache2[0],\n      setDataSourceCache = _useDataSourceCache2[1];\n\n  var _useState11 = (0, _react.useState)(props.summaryReducer ? props.summaryReducer.initialValue : null),\n      _useState12 = (0, _slicedToArray2.default)(_useState11, 2),\n      summary = _useState12[0],\n      setSummary = _useState12[1];\n\n  var setItemAt = function setItemAt(index, item, config) {\n    var replace = config && config.replace;\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return;\n    }\n\n    var newItem = computedProps.getItemAt(index);\n    var oldId = computedProps.getItemId(newItem);\n\n    if (!newItem) {\n      return;\n    }\n\n    if (replace) {\n      newItem = item;\n    } else {\n      if (config && config.property) {\n        newItem = _objectSpread(_objectSpread({}, newItem), {}, (0, _defineProperty2.default)({}, config.property, config.value));\n      } else {\n        newItem = _objectSpread(_objectSpread({}, newItem), item);\n      }\n    }\n\n    var newId = computedProps.getItemId(newItem);\n\n    if (newId !== oldId) {\n      if (computedProps.showWarnings) {\n        console.error(\"Cannot replace the item with another one that has a different value for the idProperty!\");\n      }\n\n      return;\n    }\n\n    setDataSourceCache(_objectSpread(_objectSpread({}, computedProps.computedDataSourceCache), {}, (0, _defineProperty2.default)({}, newId, newItem)));\n  };\n\n  var setItemPropertyAt = function setItemPropertyAt(index, property, value) {\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return;\n    }\n\n    if (property === computedProps.idProperty) {\n      if (computedProps.showWarnings) {\n        console.error(\"Cannot update the value of the \\\"idProperty\\\" property!\");\n      }\n    }\n\n    var item = computedProps.getItemAt(index);\n\n    if (item) {\n      item = _objectSpread({}, item);\n      item[property] = value;\n      setItemAt(index, item, {\n        property: property,\n        value: value\n      });\n    }\n  };\n\n  var setItemPropertyForId = function setItemPropertyForId(id, property, value) {\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return;\n    }\n\n    var index = computedProps.getRowIndexById(id);\n    setItemPropertyAt(index, property, value);\n  };\n\n  var _useData = useData({\n    dataSource: props.dataSource,\n    skip: computedSkip,\n    limit: computedLimit,\n    localPagination: computedLocalPagination\n  }, props.context),\n      data = _useData.data,\n      dataMap = _useData.dataMap,\n      dataIndexMap = _useData.dataIndexMap,\n      setDataIndexMap = _useData.setDataIndexMap,\n      setDataMap = _useData.setDataMap,\n      count = _useData.count,\n      silentSetData = _useData.silentSetData,\n      setCount = _useData.setCount,\n      originalData = _useData.originalData,\n      setOriginalData = _useData.setOriginalData,\n      dataCountAfterFilter = _useData.dataCountAfterFilter,\n      setDataCountAfterFilter = _useData.setDataCountAfterFilter;\n\n  var _useState13 = (0, _react.useState)(Date.now),\n      _useState14 = (0, _slicedToArray2.default)(_useState13, 2),\n      reloadTimestamp = _useState14[0],\n      setReloadTimestamp = _useState14[1];\n\n  var reload = function reload() {\n    setReloadTimestamp(Date.now());\n  };\n\n  var lastSkipRef = (0, _react.useRef)(computedSkip);\n  var lastFilterValueRef = (0, _react.useRef)(computedProps.computedFilterValue);\n  var lastLimitRef = (0, _react.useRef)(computedLimit);\n  var lastGroupBy = (0, _usePrevious.default)(computedProps.computedGroupBy, computedProps.computedGroupBy);\n  var lastDataSource = (0, _usePrevious.default)(props.dataSource, props.dataSource);\n  var dataPromiseRef = (0, _react.useRef)(null);\n  dataPromiseRef.current = (0, _useLoadDataEffect.default)({\n    getDataSource: function getDataSource(_ref8) {\n      var shouldReload = _ref8.shouldReload;\n      var computedProps = computedPropsRef.current;\n      return shouldReload ? computedProps.dataSource : computedProps.originalData;\n    }\n  }, function (dataToLoad, _ref9) {\n    var shouldReload = _ref9.shouldReload;\n    var _computedPropsRef$cur = computedPropsRef.current,\n        computedSortInfo = _computedPropsRef$cur.computedSortInfo,\n        computedRemoteData = _computedPropsRef$cur.computedRemoteData,\n        computedFilterValue = _computedPropsRef$cur.computedFilterValue,\n        computedGroupBy = _computedPropsRef$cur.computedGroupBy,\n        prevOriginalData = _computedPropsRef$cur.originalData,\n        skipLoadOnMount = _computedPropsRef$cur.skipLoadOnMount,\n        wasMountedRef = _computedPropsRef$cur.wasMountedRef,\n        initialState = _computedPropsRef$cur.initialState;\n\n    if (!prevOriginalData.length && computedRemoteData) {\n      computedPropsRef.current.setLoading(true);\n    }\n\n    var initialCount;\n\n    if (skipLoadOnMount && !wasMountedRef.current && initialState && initialState.data) {\n      dataToLoad = initialState.data;\n      initialCount = initialState.count;\n    }\n\n    if (computedRemoteData && !Array.isArray(dataToLoad)) {\n      computedPropsRef.current.setLoading(true);\n    }\n\n    var skipControlled = (0, _isControlledProperty.default)(computedProps.initialProps, 'skip');\n    var shouldResetSkip = shouldReload && typeof props.dataSource === 'function' && props.dataSource !== lastDataSource && !skipControlled && computedPropsRef.current.computedSkip !== 0;\n\n    if (!shouldResetSkip) {\n      if (shouldReload && typeof props.dataSource === 'function' && computedPropsRef.current.computedSkip !== 0 && computedPropsRef.current.computedFilterable && (!(0, _fastDeepEqual.default)(computedPropsRef.current.computedFilterValue, lastFilterValueRef.current) || computedPropsRef.current.computedGroupBy !== lastGroupBy)) {\n        shouldResetSkip = true;\n      }\n    }\n\n    if (shouldResetSkip) {\n      setSkip(0);\n      return Promise.resolve(true);\n    }\n\n    return loadDataSource(dataToLoad, {\n      sortInfo: computedSortInfo,\n      skip: computedSkip,\n      limit: computedLimit,\n      filterValue: computedFilterValue,\n      groupBy: computedGroupBy\n    }).then(function (_ref10) {\n      var originalData = _ref10.data,\n          count = _ref10.count;\n\n      if (initialCount) {\n        count = initialCount;\n      }\n\n      var computedProps = computedPropsRef.current;\n      var queue = (0, _batchUpdate.default)();\n      var data = originalData;\n      var shouldAppend = computedLivePagination && !shouldReload ? computedSkip > lastSkipRef.current : append;\n\n      if (shouldAppend) {\n        originalData = prevOriginalData.concat(originalData);\n        data = originalData;\n      }\n\n      var computeDataResult = (0, _computeData.default)({\n        remoteData: false,\n        originalData: originalData\n      }, computedProps, queue);\n      data = computeDataResult.data || originalData;\n      var dataCountAfterFilter = computeDataResult.dataCountAfterFilter;\n      var prevComputedSkip = lastSkipRef.current;\n      lastSkipRef.current = computedSkip;\n      lastFilterValueRef.current = computedFilterValue;\n      lastLimitRef.current = computedLimit;\n      var shouldIndexData = computedProps.computedRowSelectionEnabled || computedProps.computedRowExpandEnabled || computedProps.treeColumn || computedProps.treeEnabled || computedProps.rowIndexColumn || computedProps.computedRowHeights || computedProps.computedGroupBy && props.stickyGroupRows;\n      var dataIndexMap = shouldIndexData && Array.isArray(data) ? {} : null;\n      var stickyGroupsIndexes = props.stickyGroupRows === true ? {} : null;\n      var dataMap = shouldIndexData && Array.isArray(data) ? data.reduce(function (acc, item, index) {\n        var id = computedProps.getItemId(item);\n\n        if (stickyGroupsIndexes && item.__group) {\n          stickyGroupsIndexes[index] = item.depth;\n        }\n\n        acc[id] = item;\n        dataIndexMap[id] = index;\n        return acc;\n      }, {}) : null;\n      return queue.commit(function () {\n        var computedProps = computedPropsRef.current;\n        setOriginalData(originalData);\n\n        if (computedProps.scrollTopOnSort && computedProps.loadDataTrigger.find(function (s) {\n          return s == 'sortInfo';\n        })) {\n          raf(function () {\n            computedProps.setScrollTop(0);\n          });\n        }\n\n        if (computedSkip === 0 && prevComputedSkip > 0) {\n          raf(function () {\n            computedProps.setScrollTop(0);\n          });\n        }\n\n        if (computedProps.scrollTopOnFilter && computedProps.loadDataTrigger.find(function (s) {\n          return s == 'filterValue';\n        })) {\n          raf(function () {\n            computedProps.setScrollTop(0);\n          });\n        }\n\n        setLoadDataTrigger([]);\n\n        if (append) {\n          setAppend(false);\n        }\n\n        computedProps.setDataMap(dataMap);\n        computedProps.setDataIndexMap(dataIndexMap);\n\n        if (stickyGroupsIndexes && computedProps.setStickyGroupsIndexes) {\n          computedProps.setStickyGroupsIndexes(stickyGroupsIndexes);\n        }\n\n        setDataCountAfterFilter(dataCountAfterFilter);\n\n        if (dataCountAfterFilter != null && computedSkip >= dataCountAfterFilter && !computedRemoteData) {\n          setSkip(0);\n        }\n\n        silentSetData(data || []);\n        computedProps.setLoading(false);\n\n        if (shouldReload) {\n          setCount(count);\n        }\n      });\n    });\n  }, {\n    reloadDeps: [props.dataSource, computedRemoteData ? computedSkip : null, computedRemoteData && !computedLivePagination ? computedLimit : null, reloadTimestamp, props.pagination, props.remotePagination, props.pivot, props.livePagination, computedRemoteData || props.groupBy ? computedProps.computedGroupBy : null, computedRemoteData ? JSON.stringify(computedProps.computedSortInfo) : null, computedRemoteData ? JSON.stringify(computedProps.computedFilterValue) : null, computedRemoteFilter ? JSON.stringify(computedProps.computedFilterValue) : null],\n    noReloadDeps: [originalData, computedProps.computedGroupBy, computedProps.groupColumn, computedProps.showGroupSummaryRow, !computedRemoteData ? computedSkip : null, !computedRemoteData ? computedLimit : null, !computedRemoteData ? JSON.stringify(computedProps.computedSortInfo) : null, !computedRemoteFilter ? JSON.stringify(computedProps.computedFilterValue) : null, JSON.stringify(computedProps.computedCollapsedGroups || ''), computedProps.computedExpandedNodes ? JSON.stringify(computedProps.computedExpandedNodes) : null, computedProps.computedNodeCache ? JSON.stringify(computedProps.computedNodeCache) : null, computedProps.computedLoadingNodes ? JSON.stringify(computedProps.computedLoadingNodes) : null, computedDataSourceCache, computedProps.stickyGroupRows]\n  });\n  var paginationProps = usePagination({\n    append: append,\n    reload: reload,\n    setAppend: setAppend,\n    lastSkipRef: lastSkipRef,\n    lastLimitRef: lastLimitRef,\n    skip: computedSkip,\n    limit: computedLimit,\n    count: count,\n    setSkip: setSkip,\n    setLimit: setLimit,\n    pagination: computedPagination,\n    livePagination: computedLivePagination,\n    localPagination: computedLocalPagination,\n    remotePagination: computedRemotePagination,\n    dataCountAfterFilter: dataCountAfterFilter,\n    originalData: originalData,\n    data: data\n  }, computedPropsRef);\n  var getRowIndexById = (0, _react.useCallback)(function (rowId, data) {\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return -1;\n    }\n\n    var dataIndexMap = computedProps.dataIndexMap;\n\n    if (dataIndexMap) {\n      return dataIndexMap[rowId];\n    }\n\n    data = data || computedProps.data;\n    return (0, _getIndexBy.default)(data, computedProps.idProperty, rowId);\n  }, []);\n  var getItemIndexById = (0, _react.useCallback)(function (id, data) {\n    return getRowIndexById(id, data);\n  }, []);\n  var getData = (0, _react.useCallback)(function () {\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return [];\n    }\n\n    return computedProps.data;\n  }, []);\n  return _objectSpread({\n    getData: getData,\n    getRowIndexById: getRowIndexById,\n    getItemIndexById: getItemIndexById,\n    data: data,\n    dataMap: dataMap,\n    setDataMap: setDataMap,\n    dataIndexMap: dataIndexMap,\n    setDataIndexMap: setDataIndexMap,\n    loadDataTrigger: loadDataTrigger,\n    setLoadDataTrigger: setLoadDataTrigger,\n    originalData: originalData,\n    setOriginalData: setOriginalData,\n    ungroupedData: ungroupedData,\n    setUngroupedData: setUngroupedData,\n    computedSkip: computedSkip,\n    computedPagination: computedPagination,\n    computedLimit: computedLimit,\n    computedSummary: summary,\n    setSummary: setSummary,\n    dataPromiseRef: dataPromiseRef,\n    setSkip: setSkip,\n    setLimit: setLimit,\n    silentSetData: silentSetData,\n    computedLivePagination: computedLivePagination,\n    computedLocalPagination: computedLocalPagination,\n    computedRemotePagination: computedRemotePagination,\n    computedRemoteData: computedRemoteData,\n    computedRemoteFilter: computedRemoteFilter,\n    computedRemoteSort: computedRemoteSort,\n    computedDataSourceCache: computedDataSourceCache,\n    setDataSourceCache: setDataSourceCache,\n    setItemPropertyAt: setItemPropertyAt,\n    setItemPropertyForId: setItemPropertyForId,\n    setItemAt: setItemAt\n  }, paginationProps);\n};\n\nexports.default = _default;","map":{"version":3,"sources":["/Users/kathiavargas/node_modules/@inovua/reactdatagrid-community/hooks/useDataSource/index.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","default","isLivePagination","_toConsumableArray2","_defineProperty2","_slicedToArray2","_react","_clamp","_getIndexBy","_fastDeepEqual","_useLoadDataEffect","_useProperty7","_useNamedState9","_computeData","_batchUpdate","_usePrevious","_isControlledProperty","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","raf","global","requestAnimationFrame","isRemoteData","props","dataSource","then","isRemoteSort","remoteSort","undefined","isRemoteFilter","remoteFilter","isPagination","pagination","isLocalPagination","isRemotePagination","livePagination","remotePagination","loadDataSource","_ref","skip","limit","sortInfo","filterValue","groupBy","Promise","result","Array","isArray","data","count","resolve","useData","_ref2","context","localPagination","silentSetData","_useNamedState","_useNamedState2","_useState","useState","_useState2","dataMap","setDataMap","_useState3","_useState4","dataIndexMap","setDataIndexMap","originalData","setOriginalData","_useNamedState3","_useNamedState4","_useNamedState5","_useNamedState6","setCount","_useNamedState7","_useNamedState8","dataCountAfterFilter","setDataCountAfterFilter","getDataCountForPagination","paginationCount","getCurrentPage","Math","floor","getPageCount","_ref3","ceil","getSkipForPage","_ref4","page","max","hasNextPage","_ref5","hasPrevPage","_ref6","currentPage","usePagination","_ref7","computedPropsRef","append","reload","setAppend","silentSetSkip","setSkip","silentSetLimit","setLimit","lastSkipRef","lastLimitRef","setLimitOrSkip","computedProps","config","queue","current","computedRemoteData","commit","setLoadDataTrigger","loadDataTrigger","concat","incrementSkip","amount","gotoNextPage","gotoPrevPage","gotoPage","force","hasNext","hasPrev","gotoFirstPage","gotoLastPage","paginationProps","onSkipChange","onLimitChange","onRefresh","totalCount","useDataSourceCache","prevDataSource","_useProperty","onChange","dataSourceCache","info","initialProps","onDataSourceCacheChange","_useProperty2","setDataSourceCache","clearDataSourceCacheOnChange","useLayoutEffect","_default","computedRemoteFilter","computedRemoteSort","computedLivePagination","computedRemotePagination","computedLocalPagination","computedPagination","_useState5","_useState6","ungroupedData","setUngroupedData","_useState7","_useState8","_useState9","_useState10","_useProperty3","_useProperty4","computedSkip","_useProperty5","_useProperty6","computedLimit","_useDataSourceCache","_useDataSourceCache2","computedDataSourceCache","_useState11","summaryReducer","initialValue","_useState12","summary","setSummary","setItemAt","index","item","replace","newItem","getItemAt","oldId","getItemId","property","newId","showWarnings","console","error","setItemPropertyAt","idProperty","setItemPropertyForId","id","getRowIndexById","_useData","_useState13","Date","now","_useState14","reloadTimestamp","setReloadTimestamp","useRef","lastFilterValueRef","computedFilterValue","lastGroupBy","computedGroupBy","lastDataSource","dataPromiseRef","getDataSource","_ref8","shouldReload","dataToLoad","_ref9","_computedPropsRef$cur","computedSortInfo","prevOriginalData","skipLoadOnMount","wasMountedRef","initialState","setLoading","initialCount","skipControlled","shouldResetSkip","computedFilterable","_ref10","shouldAppend","computeDataResult","remoteData","prevComputedSkip","shouldIndexData","computedRowSelectionEnabled","computedRowExpandEnabled","treeColumn","treeEnabled","rowIndexColumn","computedRowHeights","stickyGroupRows","stickyGroupsIndexes","reduce","acc","__group","depth","scrollTopOnSort","find","s","setScrollTop","scrollTopOnFilter","setStickyGroupsIndexes","reloadDeps","pivot","JSON","stringify","noReloadDeps","groupColumn","showGroupSummaryRow","computedCollapsedGroups","computedExpandedNodes","computedNodeCache","computedLoadingNodes","useCallback","rowId","getItemIndexById","getData","computedSummary"],"mappings":"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","sourcesContent":["/** \n * Copyright (c) INOVUA SOFTWARE TECHNOLOGIES.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.isLivePagination = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = require(\"react\");\n\nvar _clamp = _interopRequireDefault(require(\"../../utils/clamp\"));\n\nvar _getIndexBy = _interopRequireDefault(require(\"../../utils/getIndexBy\"));\n\nvar _fastDeepEqual = _interopRequireDefault(require(\"fast-deep-equal\"));\n\nvar _useLoadDataEffect = _interopRequireDefault(require(\"../useLoadDataEffect\"));\n\nvar _useProperty7 = _interopRequireDefault(require(\"../useProperty\"));\n\nvar _useNamedState9 = _interopRequireDefault(require(\"../useNamedState\"));\n\nvar _computeData = _interopRequireDefault(require(\"./computeData\"));\n\nvar _batchUpdate = _interopRequireDefault(require(\"../../utils/batchUpdate\"));\n\nvar _usePrevious = _interopRequireDefault(require(\"../usePrevious\"));\n\nvar _isControlledProperty = _interopRequireDefault(require(\"../../utils/isControlledProperty\"));\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar raf = global.requestAnimationFrame;\n\nvar isRemoteData = function isRemoteData(props) {\n  if (props.dataSource == null) {\n    return false;\n  }\n\n  return typeof props.dataSource.then === 'function' || typeof props.dataSource === 'function';\n};\n\nvar isRemoteSort = function isRemoteSort(props) {\n  var remoteSort = props.remoteSort;\n  return remoteSort === true || remoteSort === undefined && isRemoteData(props);\n};\n\nvar isRemoteFilter = function isRemoteFilter(props) {\n  var remoteFilter = props.remoteFilter;\n  return remoteFilter === true || remoteFilter === undefined && isRemoteData(props);\n};\n\nvar isPagination = function isPagination(props) {\n  return !!props.pagination;\n};\n\nvar isLocalPagination = function isLocalPagination(props) {\n  return isPagination(props) && !isRemotePagination(props);\n};\n\nvar isLivePagination = function isLivePagination(props) {\n  return !!props.livePagination && isRemotePagination(props);\n};\n\nexports.isLivePagination = isLivePagination;\n\nvar isRemotePagination = function isRemotePagination(props) {\n  var remotePagination = props.remotePagination,\n      pagination = props.pagination,\n      livePagination = props.livePagination;\n\n  if (pagination === false || pagination === 'local') {\n    return false;\n  }\n\n  if (pagination === 'remote' || isRemoteData(props)) {\n    return true;\n  }\n\n  if (remotePagination !== undefined) {\n    return remotePagination;\n  }\n\n  return !!livePagination;\n};\n\nvar loadDataSource = function loadDataSource(dataSource, _ref) {\n  var skip = _ref.skip,\n      limit = _ref.limit,\n      sortInfo = _ref.sortInfo,\n      filterValue = _ref.filterValue,\n      groupBy = _ref.groupBy;\n\n  if (typeof dataSource === 'function') {\n    dataSource = loadDataSource(dataSource({\n      skip: skip,\n      limit: limit,\n      sortInfo: sortInfo,\n      filterValue: filterValue,\n      groupBy: groupBy\n    }), {\n      skip: skip,\n      limit: limit,\n      sortInfo: sortInfo,\n      groupBy: groupBy,\n      filterValue: filterValue\n    });\n  }\n\n  if (dataSource instanceof Promise) {\n    return dataSource.then(function (result) {\n      if (Array.isArray(result)) {\n        return {\n          data: result,\n          count: result.length\n        };\n      }\n\n      return {\n        data: result.data,\n        count: result.count\n      };\n    });\n  }\n\n  return Promise.resolve({\n    data: dataSource,\n    count: dataSource.length\n  });\n};\n\nvar useData = function useData(_ref2, context) {\n  var dataSource = _ref2.dataSource,\n      skip = _ref2.skip,\n      limit = _ref2.limit,\n      localPagination = _ref2.localPagination;\n  var data;\n  var silentSetData;\n\n  var _useNamedState = (0, _useNamedState9.default)([], context, 'data');\n\n  var _useNamedState2 = (0, _slicedToArray2.default)(_useNamedState, 2);\n\n  data = _useNamedState2[0];\n  silentSetData = _useNamedState2[1];\n\n  var _useState = (0, _react.useState)(null),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      dataMap = _useState2[0],\n      setDataMap = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(null),\n      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n      dataIndexMap = _useState4[0],\n      setDataIndexMap = _useState4[1];\n\n  var originalData;\n  var setOriginalData;\n\n  var _useNamedState3 = (0, _useNamedState9.default)(Array.isArray(dataSource) ? dataSource : [], context, 'originalData');\n\n  var _useNamedState4 = (0, _slicedToArray2.default)(_useNamedState3, 2);\n\n  originalData = _useNamedState4[0];\n  setOriginalData = _useNamedState4[1];\n\n  var _useNamedState5 = (0, _useNamedState9.default)(data.length, context, 'count'),\n      _useNamedState6 = (0, _slicedToArray2.default)(_useNamedState5, 2),\n      count = _useNamedState6[0],\n      setCount = _useNamedState6[1];\n\n  var _useNamedState7 = (0, _useNamedState9.default)(0, context, 'dataCountAfterFilter'),\n      _useNamedState8 = (0, _slicedToArray2.default)(_useNamedState7, 2),\n      dataCountAfterFilter = _useNamedState8[0],\n      setDataCountAfterFilter = _useNamedState8[1];\n\n  return {\n    setDataMap: setDataMap,\n    dataMap: dataMap,\n    dataIndexMap: dataIndexMap,\n    setDataIndexMap: setDataIndexMap,\n    originalData: originalData,\n    setOriginalData: setOriginalData,\n    data: data,\n    count: count,\n    dataCountAfterFilter: dataCountAfterFilter,\n    silentSetData: silentSetData,\n    setDataCountAfterFilter: setDataCountAfterFilter,\n    setCount: setCount\n  };\n};\n\nvar getDataCountForPagination = function getDataCountForPagination(props) {\n  var paginationCount = props.remotePagination ? props.count : props.dataCountAfterFilter != null ? props.dataCountAfterFilter : props.originalData.length;\n  return paginationCount;\n};\n\nvar getCurrentPage = function getCurrentPage(props) {\n  return Math.floor(props.skip / props.limit) + 1;\n};\n\nvar getPageCount = function getPageCount(_ref3) {\n  var count = _ref3.count,\n      limit = _ref3.limit;\n  return Math.ceil(count / limit);\n};\n\nvar getSkipForPage = function getSkipForPage(_ref4) {\n  var page = _ref4.page,\n      limit = _ref4.limit;\n  return Math.max(0, limit * (page - 1));\n};\n\nvar hasNextPage = function hasNextPage(_ref5) {\n  var skip = _ref5.skip,\n      limit = _ref5.limit,\n      count = _ref5.count;\n  return getCurrentPage({\n    skip: skip,\n    limit: limit\n  }) < getPageCount({\n    count: count,\n    limit: limit\n  });\n};\n\nvar hasPrevPage = function hasPrevPage(_ref6) {\n  var skip = _ref6.skip,\n      limit = _ref6.limit,\n      count = _ref6.count;\n  var currentPage = getCurrentPage({\n    skip: skip,\n    limit: limit\n  });\n  return currentPage > 1 && currentPage - 1 < getPageCount({\n    count: count,\n    limit: limit\n  });\n};\n\nvar usePagination = function usePagination(_ref7, computedPropsRef) {\n  var append = _ref7.append,\n      reload = _ref7.reload,\n      setAppend = _ref7.setAppend,\n      skip = _ref7.skip,\n      limit = _ref7.limit,\n      count = _ref7.count,\n      silentSetSkip = _ref7.setSkip,\n      silentSetLimit = _ref7.setLimit,\n      remotePagination = _ref7.remotePagination,\n      localPagination = _ref7.localPagination,\n      pagination = _ref7.pagination,\n      lastSkipRef = _ref7.lastSkipRef,\n      lastLimitRef = _ref7.lastLimitRef,\n      dataCountAfterFilter = _ref7.dataCountAfterFilter,\n      livePagination = _ref7.livePagination,\n      originalData = _ref7.originalData,\n      data = _ref7.data;\n  var paginationCount = getDataCountForPagination({\n    originalData: originalData,\n    remotePagination: remotePagination,\n    count: count,\n    dataCountAfterFilter: dataCountAfterFilter\n  });\n\n  var setLimitOrSkip = function setLimitOrSkip(computedProps, config, queue) {\n    return (0, _computeData.default)(_objectSpread(_objectSpread({\n      skip: skip,\n      limit: limit\n    }, config), {}, {\n      localPagination: localPagination\n    }), computedProps, queue);\n  };\n\n  var setSkip = function setSkip(skip, config) {\n    var computedProps = computedPropsRef.current;\n    var queue = (0, _batchUpdate.default)();\n    var computedRemoteData = computedProps.computedRemoteData;\n    queue.commit(function () {\n      if (config && config.append !== undefined) {\n        setAppend(config.append);\n      }\n\n      if (computedRemoteData) {\n        computedProps.setLoadDataTrigger(function (loadDataTrigger) {\n          return [].concat((0, _toConsumableArray2.default)(loadDataTrigger), ['skip']);\n        });\n      }\n\n      silentSetSkip(skip);\n    });\n  };\n\n  var setLimit = function setLimit(limit) {\n    var computedProps = computedPropsRef.current;\n    var queue = (0, _batchUpdate.default)();\n    var computedRemoteData = computedProps.computedRemoteData;\n    queue.commit(function () {\n      if (computedRemoteData) {\n        computedProps.setLoadDataTrigger(function (loadDataTrigger) {\n          return [].concat((0, _toConsumableArray2.default)(loadDataTrigger), ['limit']);\n        });\n      }\n\n      silentSetLimit(limit);\n    });\n  };\n\n  var incrementSkip = function incrementSkip(amount, config) {\n    setSkip(skip + amount, config);\n  };\n\n  var gotoNextPage = function gotoNextPage(config) {\n    if (hasNextPage({\n      skip: skip,\n      limit: lastLimitRef.current,\n      count: paginationCount\n    })) {\n      incrementSkip(lastLimitRef.current, config);\n    }\n  };\n\n  var gotoPrevPage = function gotoPrevPage() {\n    if (hasPrevPage({\n      skip: skip,\n      limit: limit,\n      count: paginationCount\n    })) {\n      incrementSkip(-limit);\n    }\n  };\n\n  var gotoPage = function gotoPage(page, config) {\n    page = (0, _clamp.default)(page, 1, getPageCount({\n      count: paginationCount,\n      limit: limit\n    }));\n    var force = config ? config.force : false;\n\n    if (page === getCurrentPage({\n      skip: skip,\n      limit: limit\n    }) && !force) {\n      return;\n    }\n\n    setSkip(getSkipForPage({\n      page: page,\n      limit: limit\n    }));\n  };\n\n  var hasNext = function hasNext() {\n    return hasNextPage({\n      skip: skip,\n      limit: limit,\n      count: paginationCount\n    });\n  };\n\n  var hasPrev = function hasPrev() {\n    return hasPrevPage({\n      skip: skip,\n      limit: limit,\n      count: paginationCount\n    });\n  };\n\n  var gotoFirstPage = function gotoFirstPage() {\n    return gotoPage(1);\n  };\n\n  var gotoLastPage = function gotoLastPage() {\n    return gotoPage(getPageCount({\n      count: paginationCount,\n      limit: limit\n    }));\n  };\n\n  var paginationProps;\n\n  if ((localPagination || remotePagination) && !livePagination) {\n    paginationProps = {\n      onSkipChange: setSkip,\n      onLimitChange: setLimit,\n      reload: reload,\n      onRefresh: reload,\n      totalCount: paginationCount,\n      count: count,\n      skip: skip,\n      limit: limit,\n      remotePagination: remotePagination,\n      localPagination: localPagination,\n      livePagination: livePagination,\n      pagination: pagination,\n      gotoNextPage: gotoNextPage,\n      gotoFirstPage: gotoFirstPage,\n      gotoLastPage: gotoLastPage,\n      gotoPrevPage: gotoPrevPage,\n      hasNextPage: hasNext,\n      hasPrevPage: hasPrev\n    };\n  }\n\n  return {\n    count: count,\n    paginationCount: paginationCount,\n    reload: reload,\n    setSkip: setSkip,\n    setLimit: setLimit,\n    gotoNextPage: gotoNextPage,\n    gotoPrevPage: gotoPrevPage,\n    hasNextPage: hasNext,\n    hasPrevPage: hasPrev,\n    gotoFirstPage: gotoFirstPage,\n    gotoLastPage: gotoLastPage,\n    paginationProps: paginationProps\n  };\n};\n\nvar useDataSourceCache = function useDataSourceCache(props, computedProps, computedPropsRef) {\n  var prevDataSource = (0, _usePrevious.default)(props.dataSource, props.dataSource);\n\n  var _useProperty = (0, _useProperty7.default)(props, 'dataSourceCache', undefined, {\n    onChange: function onChange(dataSourceCache, info) {\n      var computedProps = computedPropsRef.current;\n\n      if (!computedProps) {\n        return;\n      }\n\n      if (computedProps.initialProps.onDataSourceCacheChange) {\n        computedProps.initialProps.onDataSourceCacheChange(dataSourceCache, info);\n      }\n    }\n  }),\n      _useProperty2 = (0, _slicedToArray2.default)(_useProperty, 2),\n      dataSourceCache = _useProperty2[0],\n      setDataSourceCache = _useProperty2[1];\n\n  if (props.clearDataSourceCacheOnChange && prevDataSource !== props.dataSource) {\n    dataSourceCache = undefined;\n  }\n\n  (0, _react.useLayoutEffect)(function () {\n    if (props.clearDataSourceCacheOnChange) {\n      setDataSourceCache(undefined);\n    }\n  }, [props.dataSource]);\n  return [dataSourceCache, setDataSourceCache];\n};\n\nvar _default = function _default(props, computedProps, computedPropsRef) {\n  var computedRemoteData = isRemoteData(props);\n  var computedRemoteFilter = isRemoteFilter(props);\n  var computedRemoteSort = isRemoteSort(props);\n  var computedLivePagination = isLivePagination(props);\n  var computedRemotePagination = isRemotePagination(props);\n  var computedLocalPagination = isLocalPagination(props);\n  var computedPagination = computedRemotePagination || computedLocalPagination;\n\n  var _useState5 = (0, _react.useState)([]),\n      _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n      ungroupedData = _useState6[0],\n      setUngroupedData = _useState6[1];\n\n  var _useState7 = (0, _react.useState)([]),\n      _useState8 = (0, _slicedToArray2.default)(_useState7, 2),\n      loadDataTrigger = _useState8[0],\n      setLoadDataTrigger = _useState8[1];\n\n  var _useState9 = (0, _react.useState)(false),\n      _useState10 = (0, _slicedToArray2.default)(_useState9, 2),\n      append = _useState10[0],\n      setAppend = _useState10[1];\n\n  var _useProperty3 = (0, _useProperty7.default)(props, 'skip', 0),\n      _useProperty4 = (0, _slicedToArray2.default)(_useProperty3, 2),\n      computedSkip = _useProperty4[0],\n      setSkip = _useProperty4[1];\n\n  var _useProperty5 = (0, _useProperty7.default)(props, 'limit', 50),\n      _useProperty6 = (0, _slicedToArray2.default)(_useProperty5, 2),\n      computedLimit = _useProperty6[0],\n      setLimit = _useProperty6[1];\n\n  var _useDataSourceCache = useDataSourceCache(props, computedProps, computedPropsRef),\n      _useDataSourceCache2 = (0, _slicedToArray2.default)(_useDataSourceCache, 2),\n      computedDataSourceCache = _useDataSourceCache2[0],\n      setDataSourceCache = _useDataSourceCache2[1];\n\n  var _useState11 = (0, _react.useState)(props.summaryReducer ? props.summaryReducer.initialValue : null),\n      _useState12 = (0, _slicedToArray2.default)(_useState11, 2),\n      summary = _useState12[0],\n      setSummary = _useState12[1];\n\n  var setItemAt = function setItemAt(index, item, config) {\n    var replace = config && config.replace;\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return;\n    }\n\n    var newItem = computedProps.getItemAt(index);\n    var oldId = computedProps.getItemId(newItem);\n\n    if (!newItem) {\n      return;\n    }\n\n    if (replace) {\n      newItem = item;\n    } else {\n      if (config && config.property) {\n        newItem = _objectSpread(_objectSpread({}, newItem), {}, (0, _defineProperty2.default)({}, config.property, config.value));\n      } else {\n        newItem = _objectSpread(_objectSpread({}, newItem), item);\n      }\n    }\n\n    var newId = computedProps.getItemId(newItem);\n\n    if (newId !== oldId) {\n      if (computedProps.showWarnings) {\n        console.error(\"Cannot replace the item with another one that has a different value for the idProperty!\");\n      }\n\n      return;\n    }\n\n    setDataSourceCache(_objectSpread(_objectSpread({}, computedProps.computedDataSourceCache), {}, (0, _defineProperty2.default)({}, newId, newItem)));\n  };\n\n  var setItemPropertyAt = function setItemPropertyAt(index, property, value) {\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return;\n    }\n\n    if (property === computedProps.idProperty) {\n      if (computedProps.showWarnings) {\n        console.error(\"Cannot update the value of the \\\"idProperty\\\" property!\");\n      }\n    }\n\n    var item = computedProps.getItemAt(index);\n\n    if (item) {\n      item = _objectSpread({}, item);\n      item[property] = value;\n      setItemAt(index, item, {\n        property: property,\n        value: value\n      });\n    }\n  };\n\n  var setItemPropertyForId = function setItemPropertyForId(id, property, value) {\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return;\n    }\n\n    var index = computedProps.getRowIndexById(id);\n    setItemPropertyAt(index, property, value);\n  };\n\n  var _useData = useData({\n    dataSource: props.dataSource,\n    skip: computedSkip,\n    limit: computedLimit,\n    localPagination: computedLocalPagination\n  }, props.context),\n      data = _useData.data,\n      dataMap = _useData.dataMap,\n      dataIndexMap = _useData.dataIndexMap,\n      setDataIndexMap = _useData.setDataIndexMap,\n      setDataMap = _useData.setDataMap,\n      count = _useData.count,\n      silentSetData = _useData.silentSetData,\n      setCount = _useData.setCount,\n      originalData = _useData.originalData,\n      setOriginalData = _useData.setOriginalData,\n      dataCountAfterFilter = _useData.dataCountAfterFilter,\n      setDataCountAfterFilter = _useData.setDataCountAfterFilter;\n\n  var _useState13 = (0, _react.useState)(Date.now),\n      _useState14 = (0, _slicedToArray2.default)(_useState13, 2),\n      reloadTimestamp = _useState14[0],\n      setReloadTimestamp = _useState14[1];\n\n  var reload = function reload() {\n    setReloadTimestamp(Date.now());\n  };\n\n  var lastSkipRef = (0, _react.useRef)(computedSkip);\n  var lastFilterValueRef = (0, _react.useRef)(computedProps.computedFilterValue);\n  var lastLimitRef = (0, _react.useRef)(computedLimit);\n  var lastGroupBy = (0, _usePrevious.default)(computedProps.computedGroupBy, computedProps.computedGroupBy);\n  var lastDataSource = (0, _usePrevious.default)(props.dataSource, props.dataSource);\n  var dataPromiseRef = (0, _react.useRef)(null);\n  dataPromiseRef.current = (0, _useLoadDataEffect.default)({\n    getDataSource: function getDataSource(_ref8) {\n      var shouldReload = _ref8.shouldReload;\n      var computedProps = computedPropsRef.current;\n      return shouldReload ? computedProps.dataSource : computedProps.originalData;\n    }\n  }, function (dataToLoad, _ref9) {\n    var shouldReload = _ref9.shouldReload;\n    var _computedPropsRef$cur = computedPropsRef.current,\n        computedSortInfo = _computedPropsRef$cur.computedSortInfo,\n        computedRemoteData = _computedPropsRef$cur.computedRemoteData,\n        computedFilterValue = _computedPropsRef$cur.computedFilterValue,\n        computedGroupBy = _computedPropsRef$cur.computedGroupBy,\n        prevOriginalData = _computedPropsRef$cur.originalData,\n        skipLoadOnMount = _computedPropsRef$cur.skipLoadOnMount,\n        wasMountedRef = _computedPropsRef$cur.wasMountedRef,\n        initialState = _computedPropsRef$cur.initialState;\n\n    if (!prevOriginalData.length && computedRemoteData) {\n      computedPropsRef.current.setLoading(true);\n    }\n\n    var initialCount;\n\n    if (skipLoadOnMount && !wasMountedRef.current && initialState && initialState.data) {\n      dataToLoad = initialState.data;\n      initialCount = initialState.count;\n    }\n\n    if (computedRemoteData && !Array.isArray(dataToLoad)) {\n      computedPropsRef.current.setLoading(true);\n    }\n\n    var skipControlled = (0, _isControlledProperty.default)(computedProps.initialProps, 'skip');\n    var shouldResetSkip = shouldReload && typeof props.dataSource === 'function' && props.dataSource !== lastDataSource && !skipControlled && computedPropsRef.current.computedSkip !== 0;\n\n    if (!shouldResetSkip) {\n      if (shouldReload && typeof props.dataSource === 'function' && computedPropsRef.current.computedSkip !== 0 && computedPropsRef.current.computedFilterable && (!(0, _fastDeepEqual.default)(computedPropsRef.current.computedFilterValue, lastFilterValueRef.current) || computedPropsRef.current.computedGroupBy !== lastGroupBy)) {\n        shouldResetSkip = true;\n      }\n    }\n\n    if (shouldResetSkip) {\n      setSkip(0);\n      return Promise.resolve(true);\n    }\n\n    return loadDataSource(dataToLoad, {\n      sortInfo: computedSortInfo,\n      skip: computedSkip,\n      limit: computedLimit,\n      filterValue: computedFilterValue,\n      groupBy: computedGroupBy\n    }).then(function (_ref10) {\n      var originalData = _ref10.data,\n          count = _ref10.count;\n\n      if (initialCount) {\n        count = initialCount;\n      }\n\n      var computedProps = computedPropsRef.current;\n      var queue = (0, _batchUpdate.default)();\n      var data = originalData;\n      var shouldAppend = computedLivePagination && !shouldReload ? computedSkip > lastSkipRef.current : append;\n\n      if (shouldAppend) {\n        originalData = prevOriginalData.concat(originalData);\n        data = originalData;\n      }\n\n      var computeDataResult = (0, _computeData.default)({\n        remoteData: false,\n        originalData: originalData\n      }, computedProps, queue);\n      data = computeDataResult.data || originalData;\n      var dataCountAfterFilter = computeDataResult.dataCountAfterFilter;\n      var prevComputedSkip = lastSkipRef.current;\n      lastSkipRef.current = computedSkip;\n      lastFilterValueRef.current = computedFilterValue;\n      lastLimitRef.current = computedLimit;\n      var shouldIndexData = computedProps.computedRowSelectionEnabled || computedProps.computedRowExpandEnabled || computedProps.treeColumn || computedProps.treeEnabled || computedProps.rowIndexColumn || computedProps.computedRowHeights || computedProps.computedGroupBy && props.stickyGroupRows;\n      var dataIndexMap = shouldIndexData && Array.isArray(data) ? {} : null;\n      var stickyGroupsIndexes = props.stickyGroupRows === true ? {} : null;\n      var dataMap = shouldIndexData && Array.isArray(data) ? data.reduce(function (acc, item, index) {\n        var id = computedProps.getItemId(item);\n\n        if (stickyGroupsIndexes && item.__group) {\n          stickyGroupsIndexes[index] = item.depth;\n        }\n\n        acc[id] = item;\n        dataIndexMap[id] = index;\n        return acc;\n      }, {}) : null;\n      return queue.commit(function () {\n        var computedProps = computedPropsRef.current;\n        setOriginalData(originalData);\n\n        if (computedProps.scrollTopOnSort && computedProps.loadDataTrigger.find(function (s) {\n          return s == 'sortInfo';\n        })) {\n          raf(function () {\n            computedProps.setScrollTop(0);\n          });\n        }\n\n        if (computedSkip === 0 && prevComputedSkip > 0) {\n          raf(function () {\n            computedProps.setScrollTop(0);\n          });\n        }\n\n        if (computedProps.scrollTopOnFilter && computedProps.loadDataTrigger.find(function (s) {\n          return s == 'filterValue';\n        })) {\n          raf(function () {\n            computedProps.setScrollTop(0);\n          });\n        }\n\n        setLoadDataTrigger([]);\n\n        if (append) {\n          setAppend(false);\n        }\n\n        computedProps.setDataMap(dataMap);\n        computedProps.setDataIndexMap(dataIndexMap);\n\n        if (stickyGroupsIndexes && computedProps.setStickyGroupsIndexes) {\n          computedProps.setStickyGroupsIndexes(stickyGroupsIndexes);\n        }\n\n        setDataCountAfterFilter(dataCountAfterFilter);\n\n        if (dataCountAfterFilter != null && computedSkip >= dataCountAfterFilter && !computedRemoteData) {\n          setSkip(0);\n        }\n\n        silentSetData(data || []);\n        computedProps.setLoading(false);\n\n        if (shouldReload) {\n          setCount(count);\n        }\n      });\n    });\n  }, {\n    reloadDeps: [props.dataSource, computedRemoteData ? computedSkip : null, computedRemoteData && !computedLivePagination ? computedLimit : null, reloadTimestamp, props.pagination, props.remotePagination, props.pivot, props.livePagination, computedRemoteData || props.groupBy ? computedProps.computedGroupBy : null, computedRemoteData ? JSON.stringify(computedProps.computedSortInfo) : null, computedRemoteData ? JSON.stringify(computedProps.computedFilterValue) : null, computedRemoteFilter ? JSON.stringify(computedProps.computedFilterValue) : null],\n    noReloadDeps: [originalData, computedProps.computedGroupBy, computedProps.groupColumn, computedProps.showGroupSummaryRow, !computedRemoteData ? computedSkip : null, !computedRemoteData ? computedLimit : null, !computedRemoteData ? JSON.stringify(computedProps.computedSortInfo) : null, !computedRemoteFilter ? JSON.stringify(computedProps.computedFilterValue) : null, JSON.stringify(computedProps.computedCollapsedGroups || ''), computedProps.computedExpandedNodes ? JSON.stringify(computedProps.computedExpandedNodes) : null, computedProps.computedNodeCache ? JSON.stringify(computedProps.computedNodeCache) : null, computedProps.computedLoadingNodes ? JSON.stringify(computedProps.computedLoadingNodes) : null, computedDataSourceCache, computedProps.stickyGroupRows]\n  });\n  var paginationProps = usePagination({\n    append: append,\n    reload: reload,\n    setAppend: setAppend,\n    lastSkipRef: lastSkipRef,\n    lastLimitRef: lastLimitRef,\n    skip: computedSkip,\n    limit: computedLimit,\n    count: count,\n    setSkip: setSkip,\n    setLimit: setLimit,\n    pagination: computedPagination,\n    livePagination: computedLivePagination,\n    localPagination: computedLocalPagination,\n    remotePagination: computedRemotePagination,\n    dataCountAfterFilter: dataCountAfterFilter,\n    originalData: originalData,\n    data: data\n  }, computedPropsRef);\n  var getRowIndexById = (0, _react.useCallback)(function (rowId, data) {\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return -1;\n    }\n\n    var dataIndexMap = computedProps.dataIndexMap;\n\n    if (dataIndexMap) {\n      return dataIndexMap[rowId];\n    }\n\n    data = data || computedProps.data;\n    return (0, _getIndexBy.default)(data, computedProps.idProperty, rowId);\n  }, []);\n  var getItemIndexById = (0, _react.useCallback)(function (id, data) {\n    return getRowIndexById(id, data);\n  }, []);\n  var getData = (0, _react.useCallback)(function () {\n    var computedProps = computedPropsRef.current;\n\n    if (!computedProps) {\n      return [];\n    }\n\n    return computedProps.data;\n  }, []);\n  return _objectSpread({\n    getData: getData,\n    getRowIndexById: getRowIndexById,\n    getItemIndexById: getItemIndexById,\n    data: data,\n    dataMap: dataMap,\n    setDataMap: setDataMap,\n    dataIndexMap: dataIndexMap,\n    setDataIndexMap: setDataIndexMap,\n    loadDataTrigger: loadDataTrigger,\n    setLoadDataTrigger: setLoadDataTrigger,\n    originalData: originalData,\n    setOriginalData: setOriginalData,\n    ungroupedData: ungroupedData,\n    setUngroupedData: setUngroupedData,\n    computedSkip: computedSkip,\n    computedPagination: computedPagination,\n    computedLimit: computedLimit,\n    computedSummary: summary,\n    setSummary: setSummary,\n    dataPromiseRef: dataPromiseRef,\n    setSkip: setSkip,\n    setLimit: setLimit,\n    silentSetData: silentSetData,\n    computedLivePagination: computedLivePagination,\n    computedLocalPagination: computedLocalPagination,\n    computedRemotePagination: computedRemotePagination,\n    computedRemoteData: computedRemoteData,\n    computedRemoteFilter: computedRemoteFilter,\n    computedRemoteSort: computedRemoteSort,\n    computedDataSourceCache: computedDataSourceCache,\n    setDataSourceCache: setDataSourceCache,\n    setItemPropertyAt: setItemPropertyAt,\n    setItemPropertyForId: setItemPropertyForId,\n    setItemAt: setItemAt\n  }, paginationProps);\n};\n\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}