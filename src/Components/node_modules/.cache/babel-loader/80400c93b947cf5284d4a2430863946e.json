{"ast":null,"code":"/** \n * Copyright (c) INOVUA SOFTWARE TECHNOLOGIES.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactClass = _interopRequireDefault(require(\"../../../packages/react-class\"));\n\nvar _debounce = _interopRequireDefault(require(\"../../../packages/debounce\"));\n\nvar _contains = _interopRequireDefault(require(\"../../../packages/contains\"));\n\nvar _assignDefined2 = _interopRequireDefault(require(\"../../../packages/assign-defined\"));\n\nvar _region = _interopRequireDefault(require(\"../../../packages/region\"));\n\nvar _isMobile = _interopRequireDefault(require(\"../../../packages/isMobile\"));\n\nvar _getRangesForBoxes = _interopRequireDefault(require(\"./getRangesForBoxes\"));\n\nvar _getRangesForColumns = _interopRequireDefault(require(\"./getRangesForColumns\"));\n\nvar _setupColumnDrag = _interopRequireDefault(require(\"./setupColumnDrag\"));\n\nvar _moveXBeforeY = _interopRequireDefault(require(\"../../../utils/moveXBeforeY\"));\n\nvar _isFocusable = _interopRequireDefault(require(\"../../../utils/isFocusable\"));\n\nvar _getDropIndex2 = _interopRequireDefault(require(\"./getDropIndex\"));\n\nvar _getUndraggableSuccessiveCount = _interopRequireDefault(require(\"./getUndraggableSuccessiveCount\"));\n\nvar _DragCell = _interopRequireWildcard(require(\"./DragCell\"));\n\nvar _DragHeaderGroup = _interopRequireDefault(require(\"./DragHeaderGroup\"));\n\nvar _HeaderWrapper = _interopRequireDefault(require(\"./HeaderWrapper\"));\n\nvar _Header = require(\"./Header\");\n\nvar _getScrollbarWidth = _interopRequireDefault(require(\"../../../packages/getScrollbarWidth\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2.default)(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = (0, _getPrototypeOf2.default)(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2.default)(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar SCROLL_MARGIN = 40;\nvar DRAG_INFO = null;\n\nvar preventDefault = function preventDefault(e) {\n  return e.preventDefault();\n};\n\nvar getColumnOrder = function getColumnOrder(props, filter) {\n  var doFilter = function doFilter(c) {\n    return !c.groupColumn && filter ? filter(c) : true;\n  };\n\n  var order;\n\n  if (props.computedColumnOrder) {\n    order = props.computedColumnOrder.map(function (id) {\n      return props.columnsMap[id];\n    });\n  } else {\n    order = props.allColumns;\n  }\n\n  var toId = function toId(c) {\n    return c.id;\n  };\n\n  order = (order || []).filter(doFilter).map(toId);\n  var lockedStart = props.lockedStartColumns.filter(doFilter).map(toId);\n  var lockedMap = lockedStart.reduce(function (acc, cId) {\n    acc[cId] = true;\n    return acc;\n  }, {});\n  var lockedEnd = props.lockedEndColumns.filter(doFilter).map(toId);\n  lockedEnd.reduce(function (acc, cId) {\n    acc[cId] = true;\n    return acc;\n  }, lockedMap);\n  return [].concat((0, _toConsumableArray2.default)(lockedStart), (0, _toConsumableArray2.default)(order.filter(function (cId) {\n    return !lockedMap[cId];\n  })), (0, _toConsumableArray2.default)(lockedEnd));\n};\n\nvar getParentsForColumns = function getParentsForColumns(columns, groups, maxDepth) {\n  var parentsForColumns = columns.map(function (col) {\n    var result = [col.id].concat((0, _toConsumableArray2.default)((0, _Header.getParentGroups)(col.group, groups, {\n      includeSelf: true\n    }).map(function (g) {\n      return g.name;\n    })));\n\n    while (result.length <= maxDepth + 1) {\n      result.splice(0, 0, result[0]);\n    }\n\n    return result;\n  });\n  return parentsForColumns;\n};\n\nvar getValidDropPositions = function getValidDropPositions(_ref) {\n  var dragTargetDepth = _ref.dragTargetDepth,\n      dragTargetIndex = _ref.dragTargetIndex,\n      dragTargetLength = _ref.dragTargetLength,\n      parentsForColumns = _ref.parentsForColumns,\n      columns = _ref.columns,\n      allowGroupSplitOnReorder = _ref.allowGroupSplitOnReorder;\n\n  var getGroupsForColumn = function getGroupsForColumn(parents) {\n    parents = parents || [];\n    var initialName = parents[0];\n    var shouldCheck = true;\n    var groups = [];\n    parents.forEach(function (group) {\n      if (!shouldCheck) {\n        groups.push(group);\n        return;\n      }\n\n      if (shouldCheck && group !== initialName) {\n        shouldCheck = false;\n        groups.push(group);\n        return;\n      }\n\n      groups.push(null);\n    });\n    return groups;\n  };\n\n  var getGroupStartFor = function getGroupStartFor(parents, depth, index) {\n    var initialParent = parents[index].slice(-depth - 1)[0];\n    var itParents;\n    var currentParent;\n\n    do {\n      itParents = parents[index - 1];\n\n      if (!itParents) {\n        break;\n      }\n\n      currentParent = itParents.slice(-depth - 1)[0];\n\n      if (currentParent !== initialParent) {\n        break;\n      }\n\n      index--;\n    } while (index >= 0);\n\n    return index;\n  };\n\n  var getGroupEndFor = function getGroupEndFor(parents, depth, index) {\n    var initialParent = parents[index].slice(-depth - 1)[0];\n    var itParents;\n    var currentParent;\n\n    do {\n      index++;\n      itParents = parents[index];\n\n      if (!itParents) {\n        break;\n      }\n\n      currentParent = itParents.slice(-depth - 1)[0];\n\n      if (currentParent !== initialParent) {\n        break;\n      }\n    } while (index < parents.length);\n\n    return index;\n  };\n\n  var res = columns.reduce(function (acc, col, index) {\n    if (index > dragTargetIndex && index <= dragTargetIndex + dragTargetLength) {\n      return acc;\n    }\n\n    acc[index] = true;\n    return acc;\n  }, {});\n  res[columns.length] = true;\n\n  if (!allowGroupSplitOnReorder) {\n    var dragTargetParentGroups = getGroupsForColumn(parentsForColumns[dragTargetIndex]).filter(function (x) {\n      return x;\n    });\n    var isSingleColumn = !dragTargetParentGroups.length;\n    var usedDepth = isSingleColumn ? 0 : dragTargetDepth;\n    var parentGroupStartIndex = !usedDepth ? 0 : getGroupStartFor(parentsForColumns, usedDepth - 1, dragTargetIndex);\n    var parentGroupEndIndex = !usedDepth ? columns.length : getGroupEndFor(parentsForColumns, usedDepth - 1, dragTargetIndex);\n    var currentGroupEndIndex = getGroupEndFor(parentsForColumns, usedDepth, dragTargetIndex);\n\n    for (var i = 0; i <= columns.length; i++) {\n      delete res[i];\n    }\n\n    for (var _i = parentGroupStartIndex; _i < parentGroupEndIndex; _i++) {\n      var itGroupStartIndex = getGroupStartFor(parentsForColumns, usedDepth, _i);\n      var itGroupEndIndex = getGroupEndFor(parentsForColumns, usedDepth, _i);\n      res[itGroupStartIndex] = true;\n      res[itGroupEndIndex] = true;\n    }\n\n    var groupEndIsLastUnlocked = columns[currentGroupEndIndex] && columns[currentGroupEndIndex].computedLocked === 'end' && columns[currentGroupEndIndex - 1] && columns[currentGroupEndIndex - 1].computedLocked !== 'end';\n\n    if (!groupEndIsLastUnlocked) {\n      delete res[currentGroupEndIndex];\n    }\n  }\n\n  return res;\n};\n\nvar ReorderArrow = function (_React$Component) {\n  (0, _inherits2.default)(ReorderArrow, _React$Component);\n\n  var _super = _createSuper(ReorderArrow);\n\n  function ReorderArrow(props) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, ReorderArrow);\n    _this = _super.call(this, props);\n    _this.state = {\n      visible: false,\n      bottom: 0,\n      top: 0,\n      left: 0\n    };\n    return _this;\n  }\n\n  (0, _createClass2.default)(ReorderArrow, [{\n    key: \"set\",\n    value: function set(_ref2) {\n      var bottom = _ref2.bottom,\n          top = _ref2.top,\n          left = _ref2.left,\n          right = _ref2.right,\n          target = _ref2.target;\n      this.setState({\n        target: target,\n        bottom: bottom,\n        left: left,\n        top: top,\n        right: right\n      });\n    }\n  }, {\n    key: \"setVisible\",\n    value: function setVisible(visible) {\n      if (visible != this.state.visible) {\n        this.setState({\n          visible: visible\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var size = this.props.size;\n      var _this$state = this.state,\n          bottom = _this$state.bottom,\n          top = _this$state.top,\n          left = _this$state.left,\n          right = _this$state.right,\n          visible = _this$state.visible,\n          target = _this$state.target;\n      return _react.default.createElement(\"div\", {\n        ref: this.refReorderArrow,\n        style: {\n          position: 'absolute',\n          top: top,\n          left: left,\n          right: right,\n          width: size,\n          height: bottom - top,\n          bottom: bottom,\n          pointerEvents: 'none',\n          opacity: visible ? 1 : 0,\n          display: 'block'\n        },\n        className: \"InovuaReactDataGrid__column-reorder-arrow InovuaReactDataGrid__column-reorder-arrow--direction-\".concat(this.props.rtl ? 'rtl' : 'ltr')\n      }, _react.default.createElement(\"div\", {\n        className: \"InovuaReactDataGrid__column-reorder-arrow-fill InovuaReactDataGrid__column-reorder-arrow-fill--direction-\".concat(this.props.rtl ? 'rtl' : 'ltr', \" InovuaReactDataGrid__column-reorder-arrow-fill--target-\").concat(target || 'none')\n      }), this.props.renderReorderIndicator());\n    }\n  }]);\n  return ReorderArrow;\n}(_react.default.Component);\n\nReorderArrow.defaultProps = {\n  renderReorderIndicator: function renderReorderIndicator() {}\n};\n\nvar InovuaDataGridHeaderLayout = function (_Component) {\n  (0, _inherits2.default)(InovuaDataGridHeaderLayout, _Component);\n\n  var _super2 = _createSuper(InovuaDataGridHeaderLayout);\n\n  function InovuaDataGridHeaderLayout(props) {\n    var _this2;\n\n    (0, _classCallCheck2.default)(this, InovuaDataGridHeaderLayout);\n    _this2 = _super2.call(this, props);\n    _this2.state = {\n      draggingProps: null\n    };\n\n    _this2.refDragGroupItem = function (item) {\n      _this2.dragGroupItem = item;\n    };\n\n    _this2.refDragCell = function (cell) {\n      _this2.dragCell = cell;\n    };\n\n    _this2.refDragHeaderGroup = function (item) {\n      _this2.dragHeaderGroup = item;\n    };\n\n    _this2.groupToolbar = (0, _react.createRef)();\n\n    _this2.refHeader = function (h) {\n      _this2.headerNode = null;\n\n      if (h) {\n        _this2.headerNode = h.getDOMNode ? h.getDOMNode() : null;\n\n        if (!_this2.headerNode) {\n          throw 'Cannot find header node';\n        }\n\n        if (_isMobile.default) {\n          _this2.headerNode.addEventListener('touchmove', preventDefault);\n        }\n      } else {\n        if (_this2.headerNode && _isMobile.default) {\n          _this2.headerNode.removeEventListener('touchmove', preventDefault);\n        }\n\n        _this2.headerNode = null;\n      }\n\n      _this2.header = h;\n    };\n\n    _this2.headerWrapper = (0, _react.createRef)();\n\n    _this2.refReorderArrow = function (cmp) {\n      _this2.reorderArrow = cmp;\n    };\n\n    _this2.headerDomNode = (0, _react.createRef)();\n    _this2.lazyNotifyHeaderScrollLeftMax = (0, _debounce.default)(_this2.notifyHeaderScrollLeftMax, 150);\n    return _this2;\n  }\n\n  (0, _createClass2.default)(InovuaDataGridHeaderLayout, [{\n    key: \"notifyHeaderScrollLeftMax\",\n    value: function notifyHeaderScrollLeftMax(scrollLeftMax) {\n      if (this.header && this.props.lockedEndColumns) {\n        this.header.notifyScrollLeftMax(scrollLeftMax === undefined ? this.getScrollLeftMax() : scrollLeftMax);\n      }\n    }\n  }, {\n    key: \"onContainerScrollHorizontal\",\n    value: function onContainerScrollHorizontal(scrollLeft) {\n      this.scrollLeft = scrollLeft;\n\n      if (this.header) {\n        this.header.setScrollLeft(scrollLeft);\n        this.lazyNotifyHeaderScrollLeftMax();\n      }\n    }\n  }, {\n    key: \"setScrollLeft\",\n    value: function setScrollLeft(scrollLeft) {\n      this.props.setScrollLeft(scrollLeft);\n    }\n  }, {\n    key: \"getScrollLeft\",\n    value: function getScrollLeft() {\n      return this.scrollLeft || 0;\n    }\n  }, {\n    key: \"getScrollLeftMax\",\n    value: function getScrollLeftMax() {\n      return this.props.getScrollLeftMax();\n    }\n  }, {\n    key: \"setColumnRenderStartIndex\",\n    value: function setColumnRenderStartIndex(columnRenderStartIndex) {\n      if (this.header) {\n        this.header.setColumnRenderStartIndex(columnRenderStartIndex);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react.default.createElement(\"div\", {\n        ref: this.headerDomNode,\n        className: 'InovuaReactDataGrid__header-layout'\n      }, this.renderGroupToolbar(), this.renderHeaderWrapper(), this.renderDragCell(), this.renderDragGroupItem(), this.renderDragHeaderGroup(), this.renderReorderIndicator());\n    }\n  }, {\n    key: \"renderGroupToolbar\",\n    value: function renderGroupToolbar() {\n      var _this$props = this.props,\n          columnsMap = _this$props.columnsMap,\n          onGroupByChange = _this$props.onGroupByChange,\n          onHeaderSortClick = _this$props.onHeaderSortClick,\n          renderGroupItem = _this$props.renderGroupItem,\n          renderSortTool = _this$props.renderSortTool,\n          renderGroupToolbar = _this$props.renderGroupToolbar,\n          groupBy = _this$props.computedGroupBy,\n          i18n = _this$props.i18n,\n          rtl = _this$props.rtl,\n          theme = _this$props.theme;\n\n      if (!groupBy || !renderGroupToolbar) {\n        return null;\n      }\n\n      return renderGroupToolbar({\n        columnsMap: columnsMap,\n        groupBy: groupBy,\n        rtl: rtl,\n        theme: theme,\n        renderSortTool: renderSortTool,\n        onGroupByChange: onGroupByChange,\n        renderGroupItem: renderGroupItem,\n        headerGroupPlaceholderText: i18n('dragHeaderToGroup'),\n        onItemMouseDown: this.onGroupItemMouseDown,\n        onSortClick: onHeaderSortClick,\n        ref: this.groupToolbar\n      });\n    }\n  }, {\n    key: \"renderHeaderWrapper\",\n    value: function renderHeaderWrapper() {\n      var props = this.props;\n      var computedShowHeader = props.computedShowHeader;\n\n      if (!computedShowHeader) {\n        return null;\n      }\n\n      var scrollLeft = (this.scrollLeft !== undefined ? this.scrollLeft : props.scrollLeft) || 0;\n      var groupBy = this.props.computedGroupBy && this.props.computedGroupBy.length ? this.props.computedGroupBy : null;\n      return _react.default.createElement(_HeaderWrapper.default, (0, _extends2.default)({}, props, {\n        groupBy: groupBy,\n        onHeaderGroupMouseDown: this.onHeaderGroupMouseDown,\n        onHeaderCellMouseDown: this.onHeaderCellMouseDown,\n        onHeaderCellTouchStart: this.onHeaderCellTouchStart,\n        ref: this.headerWrapper,\n        refHeader: this.refHeader,\n        scrollLeft: scrollLeft\n      }));\n    }\n  }, {\n    key: \"renderDragCell\",\n    value: function renderDragCell() {\n      return _react.default.createElement(_DragCell.default, {\n        ref: this.refDragCell\n      });\n    }\n  }, {\n    key: \"renderDragGroupItem\",\n    value: function renderDragGroupItem() {\n      if (!this.props.renderDragGroupItem) {\n        return null;\n      }\n\n      return this.props.renderDragGroupItem(this.refDragGroupItem);\n    }\n  }, {\n    key: \"renderDragHeaderGroup\",\n    value: function renderDragHeaderGroup() {\n      if (!this.props.computedGroups) {\n        return;\n      }\n\n      return _react.default.createElement(_DragHeaderGroup.default, {\n        ref: this.refDragHeaderGroup\n      });\n    }\n  }, {\n    key: \"onGroupItemMouseDown\",\n    value: function onGroupItemMouseDown(column, index, event) {\n      this.onHeaderCellMouseDown(column, event, {\n        dragTarget: 'group',\n        dragIndex: index\n      });\n    }\n  }, {\n    key: \"getCellDOMNodeAt\",\n    value: function getCellDOMNodeAt(index) {\n      return this.header.getCellDOMNodeAt(index);\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader() {\n      return this.header;\n    }\n  }, {\n    key: \"onHeaderGroupMouseDown\",\n    value: function onHeaderGroupMouseDown(event, headerGroupProps, headerGroup) {\n      event.stopPropagation();\n\n      if (event.ctrlKey || event.metaKey) {\n        return;\n      }\n\n      if (this._dragIndex !== undefined) {\n        return;\n      }\n\n      if (headerGroupProps.group && headerGroupProps.group.draggable === false) {\n        return;\n      }\n\n      var dragTargetNode = headerGroup.domRef ? headerGroup.domRef.current : null;\n      var shouldStop = (0, _toConsumableArray2.default)(dragTargetNode.querySelectorAll('.InovuaReactDataGrid__column-header__filter-wrapper')).reduce(function (shouldStop, filterWrapperNode) {\n        if ((0, _contains.default)(filterWrapperNode, event.target) || filterWrapperNode === event.target) {\n          return true;\n        }\n\n        return shouldStop;\n      }, false);\n\n      if (shouldStop) {\n        return;\n      }\n\n      var groupColumns = headerGroupProps.columns.reduce(function (acc, colId) {\n        acc[colId] = true;\n        return acc;\n      }, {});\n      this.groupColumns = groupColumns;\n      var dragBoxes = this.header.getGroupsAndCells().filter(function (item) {\n        if (item === headerGroup) {\n          return true;\n        }\n\n        if (item.props.id in groupColumns) {\n          return false;\n        }\n\n        return !item.props.isHeaderGroup;\n      });\n      var dragIndex = dragBoxes.indexOf(headerGroup);\n      var dragTargetIndex = this.props.columnsMap[headerGroup.props.columns[0]].computedVisibleIndex;\n      var dragTargetDepth = headerGroup.props.depth;\n      var dragTargetLength = headerGroup.props.columns.length;\n      var parentsForColumns = getParentsForColumns(this.props.visibleColumns, this.props.computedGroupsMap, this.props.computedGroupsDepth);\n      this.maybeDragMouseDown(event, {\n        dragTarget: 'headergroup',\n        dragTargetIndex: dragTargetIndex,\n        dragTargetDepth: dragTargetDepth,\n        dragTargetLength: dragTargetLength,\n        parentsForColumns: parentsForColumns,\n        dragTargetNode: dragTargetNode,\n        dragIndex: dragIndex,\n        dragBoxes: dragBoxes,\n        allowTargetChange: false,\n        ranges: (0, _getRangesForBoxes.default)(dragBoxes, function (i) {\n          return i;\n        })\n      });\n    }\n  }, {\n    key: \"onHeaderCellTouchStart\",\n    value: function onHeaderCellTouchStart() {\n      return this.onHeaderCellMouseDown.apply(this, arguments);\n    }\n  }, {\n    key: \"onHeaderCellMouseDown\",\n    value: function onHeaderCellMouseDown(_ref3, event) {\n      var visibleIndex = _ref3.computedVisibleIndex;\n\n      var _ref4 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n        dragTarget: 'header'\n      },\n          _ref4$dragTarget = _ref4.dragTarget,\n          dragTarget = _ref4$dragTarget === void 0 ? 'header' : _ref4$dragTarget,\n          dragIndex = _ref4.dragIndex;\n\n      if (this.props.reorderColumns === false) {\n        return;\n      }\n\n      if ((0, _isFocusable.default)(event.target)) {\n        return;\n      }\n\n      if (event.nativeEvent.which == 3 || event.metaKey || event.ctrlKey) {\n        return;\n      }\n\n      if (dragIndex === undefined) {\n        dragIndex = visibleIndex;\n      }\n\n      if (event.ctrlKey || event.metaKey) {\n        return;\n      }\n\n      var allowTargetChange = undefined;\n      var dragColumn;\n      var dragTargetNode = this.getCellDOMNodeAt(visibleIndex);\n\n      if (dragTarget == 'header') {\n        dragColumn = this.props.visibleColumns[visibleIndex];\n\n        if (!dragColumn || dragColumn.groupColumn || dragColumn.draggable === false) {\n          event.stopPropagation();\n          return;\n        }\n\n        if (this.props.computedGroupBy) {\n          if (this.props.computedGroupBy.indexOf(dragColumn.id) != -1 || this.props.computedGroupBy.indexOf(dragColumn.name) != -1) {\n            allowTargetChange = false;\n          }\n        }\n\n        if (dragColumn.draggable === false) {\n          return;\n        }\n\n        if (dragColumn.groupBy === false) {\n          allowTargetChange = false;\n        }\n      }\n\n      var dragTargetIndex = dragIndex;\n      var dragTargetDepth = dragColumn && dragColumn.group && this.props.computedGroupsMap && this.props.computedGroupsMap[dragColumn.group] ? this.props.computedGroupsMap[dragColumn.group].computedDepth + 1 : this.props.computedGroupsDepth + 1;\n      var parentsForColumns = getParentsForColumns(this.props.visibleColumns, this.props.computedGroupsMap, this.props.computedGroupsDepth);\n      this.maybeDragMouseDown(event, {\n        dragTarget: dragTarget,\n        dragIndex: dragIndex,\n        dragTargetNode: dragTargetNode,\n        parentsForColumns: parentsForColumns,\n        dragTargetIndex: dragTargetIndex,\n        dragTargetDepth: dragTargetDepth,\n        dragTargetLength: 1,\n        allowTargetChange: allowTargetChange\n      });\n    }\n  }, {\n    key: \"maybeDragMouseDown\",\n    value: function maybeDragMouseDown(event, _ref5) {\n      var _this3 = this;\n\n      var dragTarget = _ref5.dragTarget,\n          dragIndex = _ref5.dragIndex,\n          allowTargetChange = _ref5.allowTargetChange,\n          ranges = _ref5.ranges,\n          parentsForColumns = _ref5.parentsForColumns,\n          dragTargetIndex = _ref5.dragTargetIndex,\n          dragTargetDepth = _ref5.dragTargetDepth,\n          dragTargetNode = _ref5.dragTargetNode,\n          dragTargetLength = _ref5.dragTargetLength;\n\n      if (this.props.computedPivot) {\n        return;\n      }\n\n      this._dragIndex = dragIndex;\n\n      var _removeListeners;\n\n      var mouseMoveEventCount = 0;\n      var didSetupDrag = false;\n\n      var cleanup = function cleanup() {\n        delete _this3._dragIndex;\n\n        if (_removeListeners) {\n          _removeListeners();\n        }\n      };\n\n      var onMouseUp = cleanup;\n\n      var onMouseMove = function onMouseMove(event) {\n        if (didSetupDrag) {\n          return;\n        }\n\n        mouseMoveEventCount++;\n\n        if (mouseMoveEventCount > 1) {\n          didSetupDrag = true;\n\n          _removeListeners();\n\n          _this3.setupDrag({\n            dragTarget: dragTarget,\n            dragIndex: dragIndex,\n            allowTargetChange: allowTargetChange,\n            ranges: ranges,\n            parentsForColumns: parentsForColumns,\n            dragTargetIndex: dragTargetIndex,\n            dragTargetDepth: dragTargetDepth,\n            dragTargetLength: dragTargetLength,\n            dragTargetNode: dragTargetNode\n          }, event);\n        }\n      };\n\n      var mouseup = _isMobile.default ? 'touchend' : 'mouseup';\n      var mousemove = _isMobile.default ? 'touchmove' : 'mousemove';\n\n      _removeListeners = function removeListeners() {\n        _removeListeners = null;\n        global.removeEventListener(mouseup, onMouseUp, false);\n        global.removeEventListener(mousemove, onMouseMove, false);\n      };\n\n      if (_isMobile.default) {\n        setTimeout(function () {\n          onMouseUp();\n        }, 350);\n      }\n\n      global.addEventListener(mouseup, onMouseUp, false);\n      global.addEventListener(mousemove, onMouseMove, false);\n    }\n  }, {\n    key: \"renderReorderIndicator\",\n    value: function renderReorderIndicator() {\n      var size = this.props.reorderProxySize;\n      return _react.default.createElement(ReorderArrow, {\n        ref: this.refReorderArrow,\n        size: size,\n        rtl: this.props.rtl,\n        renderReorderIndicator: this.props.renderReorderIndicator\n      });\n    }\n  }, {\n    key: \"setReorderArrowAt\",\n    value: function setReorderArrowAt(index, ranges, target) {\n      var offset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var visible = arguments.length > 4 ? arguments[4] : undefined;\n      visible = visible !== undefined ? visible : index != DRAG_INFO.dragIndex || target != DRAG_INFO.dragTarget;\n\n      if (offset) {\n        visible = true;\n      }\n\n      var rtl = this.props.rtl;\n      this.reorderArrow.setVisible(visible);\n      var last = index == ranges.length;\n      var box = ranges[index];\n      var _DRAG_INFO = DRAG_INFO,\n          headerRegion = _DRAG_INFO.headerRegion,\n          initialScrollLeft = _DRAG_INFO.initialScrollLeft;\n\n      if (!box && last) {\n        var _box;\n\n        var lastBox = ranges[ranges.length - 1] || {\n          left: headerRegion.left,\n          right: headerRegion.left\n        };\n        box = (_box = {}, (0, _defineProperty2.default)(_box, rtl ? 'right' : 'left', rtl ? lastBox.left : lastBox.right), (0, _defineProperty2.default)(_box, \"computedLocked\", lastBox.computedLocked), _box);\n      }\n\n      box = box || (rtl ? {\n        right: 0\n      } : {\n        left: 0\n      });\n      var boxPos = rtl ? box.right : box.left;\n\n      if (rtl && this.props.nativeScroll && this.props.scrollbars.vertical) {\n        boxPos -= (0, _getScrollbarWidth.default)();\n      }\n\n      return this.setReorderArrowPosition(rtl ? -boxPos + headerRegion.right - offset : boxPos - headerRegion.left + offset, target);\n    }\n  }, {\n    key: \"setReorderArrowPosition\",\n    value: function setReorderArrowPosition(pos, target) {\n      var rtl = this.props.rtl;\n      this.reorderArrowPosition = this.reorderArrowPosition || {};\n      (0, _assignDefined2.default)(this.reorderArrowPosition, (0, _defineProperty2.default)({}, rtl ? 'right' : 'left', pos));\n      this.reorderArrow.set(_objectSpread((0, _defineProperty2.default)({\n        target: target\n      }, rtl ? 'right' : 'left', rtl ? this.reorderArrowPosition.right : this.reorderArrowPosition.left), DRAG_INFO.reorderProxyPosition[target]));\n      return this;\n    }\n  }, {\n    key: \"setReorderArrowVisible\",\n    value: function setReorderArrowVisible(visible) {\n      this.reorderArrow.setVisible(visible);\n      return this;\n    }\n  }, {\n    key: \"getGroupToolbar\",\n    value: function getGroupToolbar() {\n      return this.groupToolbar.current;\n    }\n  }, {\n    key: \"getGroupByItems\",\n    value: function getGroupByItems() {\n      if (!this.groupToolbar.current) {\n        return null;\n      }\n\n      return this.groupToolbar.current.getSortedItemsInfo();\n    }\n  }, {\n    key: \"getHeaderCells\",\n    value: function getHeaderCells() {\n      return this.header.getCells();\n    }\n  }, {\n    key: \"getBoxesFor\",\n    value: function getBoxesFor(target) {\n      if (target == 'header') {\n        return this.header.getCells();\n      }\n\n      if (target == 'group' && this.groupToolbar.current) {\n        return this.groupToolbar.current.getCells();\n      }\n\n      if (target == 'headergroup') {\n        return this.header.getGroupsAndCells();\n      }\n\n      return [];\n    }\n  }, {\n    key: \"getDragBoxInstance\",\n    value: function getDragBoxInstance(dragIndex, dragTarget, dragTargetDepth, dragTargetLength) {\n      if (dragTarget === 'group') {\n        return this.getGroupToolbar().getCells()[dragIndex];\n      }\n\n      var dragCell = this.getHeaderCells()[dragIndex];\n      var dragBox = dragCell;\n\n      if (dragTargetLength) {\n        var cellProps = dragCell.getProps();\n\n        while (cellProps.depth > dragTargetDepth) {\n          if (cellProps.parent) {\n            dragBox = cellProps.parent;\n            cellProps = dragBox.props;\n          } else {\n            break;\n          }\n        }\n      }\n\n      return dragBox;\n    }\n  }, {\n    key: \"setupDrag\",\n    value: function setupDrag(_ref6, event) {\n      var _DRAG_INFO2;\n\n      var dragTarget = _ref6.dragTarget,\n          dragIndex = _ref6.dragIndex,\n          _ref6$allowTargetChan = _ref6.allowTargetChange,\n          allowTargetChange = _ref6$allowTargetChan === void 0 ? true : _ref6$allowTargetChan,\n          parentsForColumns = _ref6.parentsForColumns,\n          dragTargetIndex = _ref6.dragTargetIndex,\n          dragTargetDepth = _ref6.dragTargetDepth,\n          dragTargetLength = _ref6.dragTargetLength;\n      var columns = this.props.visibleColumns;\n      var rtl = this.props.rtl;\n\n      var headerRegion = _region.default.from(this.headerDomNode.current);\n\n      var dragBox = this.getDragBoxInstance(dragIndex, dragTarget, dragTargetDepth, dragTargetLength);\n      var initialScrollLeft = this.getScrollLeft();\n      var dragBoxProps = dragBox.getProps ? dragBox.getProps() : dragBox.props;\n      var rtlOffset = Math.max(this.props.totalComputedWidth - this.props.size.width, 0);\n      var columnRanges = (0, _getRangesForColumns.default)(columns, {\n        rtl: rtl,\n        rtlOffset: rtlOffset,\n        initialOffset: rtl ? headerRegion.right : headerRegion.left,\n        headerRegion: headerRegion,\n        initialScrollLeft: initialScrollLeft,\n        availableWidth: Math.min(this.props.availableWidth, this.props.totalComputedWidth),\n        totalLockedEndWidth: this.props.totalLockedEndWidth\n      });\n      var groupByRanges = this.props.computedGroupBy && this.props.computedGroupBy.length ? (0, _getRangesForBoxes.default)(this.getGroupToolbar().getCells()) : [];\n      var dragProxy = dragTarget == 'header' ? this.dragCell : dragTarget == 'group' ? this.dragGroupItem : this.dragHeaderGroup;\n      var dragColumn = dragTarget === 'group' ? dragBoxProps.column : columns[dragIndex];\n      var headerDragColumn = dragTarget == 'header' ? dragColumn : null;\n      var columnId = dragTarget == 'header' ? headerDragColumn.id : dragTarget == 'group' ? dragColumn.id : null;\n      var dragBoxNode = dragBox.domRef ? dragBox.domRef.current : null;\n      var dragBoxInitialRegion = dragBox && dragBox.getProxyRegion ? dragBox.getProxyRegion() : _region.default.from(dragBoxNode);\n\n      if (_DragCell.MAX_WIDTH && dragBoxInitialRegion.getWidth() > _DragCell.MAX_WIDTH) {\n        dragBoxInitialRegion.setWidth(_DragCell.MAX_WIDTH);\n      }\n\n      if (_region.default.from(dragBoxNode).getWidth() > headerRegion.getWidth() / 2) {\n        if (rtl) {\n          dragBoxInitialRegion.shift({\n            right: event.pageX - dragBoxInitialRegion.right - this.props.columnReorderScrollByAmount\n          });\n        } else {\n          dragBoxInitialRegion.shift({\n            left: event.pageX - dragBoxInitialRegion.left - this.props.columnReorderScrollByAmount\n          });\n        }\n      }\n\n      var dragBoxOffsets = (0, _defineProperty2.default)({\n        top: headerRegion.top\n      }, rtl ? 'right' : 'left', rtl ? headerRegion.right : headerRegion.left);\n      dragProxy.setProps(dragBoxProps);\n      var dragProxyPosition = (0, _defineProperty2.default)({\n        top: dragBoxInitialRegion.top - dragBoxOffsets.top\n      }, rtl ? 'right' : 'left', rtl ? dragBoxOffsets.right - dragBoxInitialRegion.right : dragBoxInitialRegion.left - dragBoxOffsets.left);\n      dragProxy.setHeight(dragBoxInitialRegion.height);\n      dragProxy.setWidth(dragBoxInitialRegion.width);\n      dragProxy.setTop(dragProxyPosition.top);\n\n      if (rtl) {\n        dragProxy.setRight(dragProxyPosition.right);\n      } else {\n        dragProxy.setLeft(dragProxyPosition.left);\n      }\n\n      this.setReorderArrowVisible(headerDragColumn ? headerDragColumn.draggable !== false : true);\n      var maxHeaderIndex = columns.length - (0, _getUndraggableSuccessiveCount.default)((0, _toConsumableArray2.default)(columns).reverse());\n      var minHeaderIndex = (0, _getUndraggableSuccessiveCount.default)(columns);\n      var validDropPositions = columns.reduce(function (acc, col, i) {\n        acc[i] = true;\n        return acc;\n      }, {});\n      validDropPositions[columns.length] = true;\n\n      if (this.props.groups && this.props.groups.length && !this.props.allowGroupSplitOnReorder) {\n        validDropPositions = getValidDropPositions({\n          dragTargetDepth: dragTargetDepth,\n          dragTargetIndex: dragTargetIndex,\n          dragTargetLength: dragTargetLength,\n          parentsForColumns: parentsForColumns,\n          columns: columns,\n          allowGroupSplitOnReorder: this.props.allowGroupSplitOnReorder,\n          maxDepth: this.props.computedGroupsDepth + 1\n        });\n      }\n\n      if (validDropPositions && !validDropPositions[dragIndex] && dragTarget != 'group') {\n        validDropPositions[dragIndex] = true;\n      }\n\n      var wrapperNode = this.headerDomNode ? this.headerDomNode.current : null;\n      var filterRowHeight = 0;\n\n      if (this.props.computedFilterable) {\n        var filterWrapperNode = wrapperNode.querySelector('.InovuaReactDataGrid__column-header__filter-wrapper');\n\n        if (filterWrapperNode) {\n          filterRowHeight = filterWrapperNode.offsetHeight;\n        }\n      }\n\n      DRAG_INFO = (_DRAG_INFO2 = {\n        allowTargetChange: allowTargetChange,\n        columnId: columnId,\n        headerRegion: headerRegion,\n        headerDragColumn: headerDragColumn,\n        minHeaderIndex: minHeaderIndex,\n        maxHeaderIndex: maxHeaderIndex,\n        dragColumn: dragColumn,\n        dragColumnsIds: dragTarget == 'headergroup' ? dragBox.props.columns : null,\n        dragBox: dragBox,\n        dragBoxInitialRegion: dragBoxInitialRegion,\n        dragBoxRegion: dragBoxInitialRegion.clone(),\n        dragBoxProps: dragBoxProps,\n        dragBoxOffsets: dragBoxOffsets,\n        dragProxy: dragProxy,\n        dragProxyInitialPosition: dragProxyPosition,\n        dragTarget: dragTarget,\n        dropTarget: dragTarget,\n        dragIndex: dragIndex,\n        columnRanges: columnRanges,\n        groupByRanges: groupByRanges,\n        parentsForColumns: parentsForColumns,\n        dragTargetIndex: dragTargetIndex,\n        dragTargetDepth: dragTargetDepth,\n        dragTargetLength: dragTargetLength,\n        scrollLeftMax: this.props.getScrollLeftMax(),\n        initialScrollLeft: initialScrollLeft\n      }, (0, _defineProperty2.default)(_DRAG_INFO2, \"headerRegion\", headerRegion), (0, _defineProperty2.default)(_DRAG_INFO2, \"validDropPositions\", validDropPositions), _DRAG_INFO2);\n      var groupToolbarNode = this.groupToolbar.current ? this.groupToolbar.current.domRef ? this.groupToolbar.current.domRef.current : null : null;\n      var headerGroupTargetNode = wrapperNode;\n      var groupTargetNode = groupToolbarNode || this.headerDomNode.current;\n      var groupComputedStyle = getComputedStyle(groupTargetNode);\n      DRAG_INFO.reorderProxyPosition = {\n        group: {\n          top: parseInt(groupComputedStyle.paddingTop),\n          bottom: groupTargetNode.offsetHeight - parseInt(groupComputedStyle.paddingBottom)\n        },\n        header: {\n          top: this.props.computedGroupBy ? groupTargetNode.offsetHeight : 0,\n          bottom: headerGroupTargetNode.offsetHeight - filterRowHeight\n        },\n        headergroup: {\n          top: this.props.computedGroupBy ? groupTargetNode.offsetHeight : 0,\n          bottom: headerGroupTargetNode.offsetHeight - filterRowHeight\n        }\n      };\n      this.setReorderArrowAt(dragIndex, dragTarget === 'group' ? groupByRanges : columnRanges, dragTarget);\n      this.setReorderArrowPosition(undefined, dragTarget);\n      dragProxy.setDragging(true);\n      this.props.coverHandleRef.current.setActive(true);\n      this.props.coverHandleRef.current.setCursor('grabbing');\n      var headerNode = this.headerDomNode ? this.headerDomNode.current : null;\n      (0, _setupColumnDrag.default)({\n        constrainTo: this.props.constrainReorder ? _region.default.from(headerNode.parentNode) : undefined,\n        region: dragBoxInitialRegion\n      }, {\n        onDrag: this.onHeaderCellDrag,\n        onDrop: this.onHeaderCellDrop\n      }, event);\n    }\n  }, {\n    key: \"onHeaderCellDrop\",\n    value: function onHeaderCellDrop() {\n      this.props.coverHandleRef.current.setActive(false);\n      delete this._dragIndex;\n      var dropIndex = this.dropIndex,\n          props = this.props;\n\n      if (dropIndex === undefined || !DRAG_INFO) {\n        if (DRAG_INFO) {\n          DRAG_INFO.dragProxy.setDragging(false);\n        }\n\n        this.setReorderArrowVisible(false);\n        DRAG_INFO = null;\n        return;\n      }\n\n      var _DRAG_INFO3 = DRAG_INFO,\n          dragColumn = _DRAG_INFO3.dragColumn,\n          columnId = _DRAG_INFO3.columnId,\n          dragColumnsIds = _DRAG_INFO3.dragColumnsIds,\n          dragTarget = _DRAG_INFO3.dragTarget,\n          dropTarget = _DRAG_INFO3.dropTarget,\n          dragProxy = _DRAG_INFO3.dragProxy,\n          newLocked = _DRAG_INFO3.newLocked;\n      var _DRAG_INFO4 = DRAG_INFO,\n          dragIndex = _DRAG_INFO4.dragIndex;\n      DRAG_INFO = null;\n      this.setReorderArrowVisible(false);\n      dragProxy.setDragging(false);\n      var columns = this.props.visibleColumns;\n      var currentLocked = columns[dragIndex].computedLocked;\n\n      if (dropIndex == dragIndex && newLocked === currentLocked && dragTarget == dropTarget) {\n        return;\n      }\n\n      if (dragTarget == 'headergroup') {\n        if (dropIndex == dragIndex && dragTarget == dropTarget) {\n          return;\n        }\n\n        if (columns[dropIndex]) {\n          this.moveColumnsBeforeIndex(dragColumnsIds, columns[dropIndex].computedVisibleIndex, newLocked);\n        } else if (dropIndex == columns.length) {\n          var col = columns[columns.length - 1];\n\n          if (col) {\n            this.moveColumnsBeforeIndex(dragColumnsIds, col.computedVisibleIndex + 1, newLocked);\n          }\n        }\n\n        return;\n      }\n\n      var visibleColumns = props.visibleColumns,\n          groupBy = props.computedGroupBy;\n\n      if (dropTarget == dragTarget) {\n        if (dragTarget == 'group') {\n          this.setGroupBy((0, _moveXBeforeY.default)(groupBy, dragIndex, dropIndex));\n        }\n\n        if (dragTarget == 'header') {\n          this.moveColumnsBeforeIndex([columnId], dropIndex, newLocked);\n        }\n      }\n\n      if (dragTarget == 'header' && dropTarget == 'group') {\n        var groupByColumn = visibleColumns[dragIndex];\n        var newGroupBy = [].concat(groupBy);\n        newGroupBy.splice(dropIndex, 0, groupByColumn.id);\n        this.setGroupBy(newGroupBy);\n      }\n\n      if (dragTarget == 'group' && dropTarget == 'header') {\n        this.ungroupColumnToIndex(columnId, dropIndex);\n      }\n    }\n  }, {\n    key: \"ungroupColumnToIndex\",\n    value: function ungroupColumnToIndex(columnId, dropIndex) {\n      var props = this.props;\n      var allColumns = props.allColumns,\n          visibleColumns = props.visibleColumns;\n      var dragColumn = allColumns.filter(function (c) {\n        return c.id === columnId;\n      })[0];\n      var newGroupBy = [].concat(this.props.computedGroupBy).filter(function (g) {\n        return g != columnId;\n      });\n      var columnAtDropIndex = visibleColumns[dropIndex];\n\n      if (columnAtDropIndex && columnAtDropIndex.id === columnId) {\n        this.setGroupBy(newGroupBy);\n        return;\n      }\n\n      var order = getColumnOrder(props, function (c) {\n        return c.id !== columnId;\n      });\n      var insertIndex = columnAtDropIndex ? order.indexOf(columnAtDropIndex.id) : order.length;\n      order.splice(insertIndex, 0, columnId);\n      var columnAtDropIndexOrLast = columnAtDropIndex || visibleColumns[visibleColumns.length - 1];\n\n      if (columnAtDropIndexOrLast.computedLocked != dragColumn.computedLocked) {\n        this.props.setColumnLocked(columnId, columnAtDropIndexOrLast.computedLocked);\n      }\n\n      this.setGroupBy(newGroupBy);\n      this.setColumnOrder(order);\n    }\n  }, {\n    key: \"moveColumnsBeforeIndex\",\n    value: function moveColumnsBeforeIndex(columnsIds, dropIndex, newLocked) {\n      var _this4 = this;\n\n      var props = this.props;\n      var visibleColumns = props.visibleColumns,\n          columnVisibilityMap = props.columnVisibilityMap,\n          allowGroupSplitOnReorder = props.allowGroupSplitOnReorder;\n      var columnOrder = getColumnOrder(props);\n      var columns = visibleColumns.filter(function (col) {\n        return columnsIds.indexOf(col.id) != -1;\n      });\n      var dragColumnsIndexesInAllColumns = columnsIds.map(function (columnId) {\n        return columnOrder.indexOf(columnId);\n      });\n      var dropBeforeIndexInAllColumns = visibleColumns[dropIndex] ? columnOrder.indexOf(visibleColumns[dropIndex].id) : columnOrder.length;\n      var firstDragIndex = dragColumnsIndexesInAllColumns[0];\n\n      if (!allowGroupSplitOnReorder && firstDragIndex < dropBeforeIndexInAllColumns) {\n        while (true) {\n          var columnRightBefore = columnOrder[dropBeforeIndexInAllColumns - 1];\n\n          if (columnRightBefore && columnVisibilityMap[columnRightBefore] === false) {\n            dropBeforeIndexInAllColumns--;\n            continue;\n          }\n\n          break;\n        }\n      }\n\n      var targetColumn = visibleColumns[dropIndex] || visibleColumns[visibleColumns.length - 1];\n      columns.forEach(function (col) {\n        if (newLocked != col.computedLocked) {\n          _this4.props.setColumnLocked(col.id, newLocked);\n        }\n      });\n      var newColumnOrder = (0, _moveXBeforeY.default)(columnOrder, dragColumnsIndexesInAllColumns, dropBeforeIndexInAllColumns);\n      this.setColumnOrder(newColumnOrder);\n    }\n  }, {\n    key: \"onHeaderCellDrag\",\n    value: function onHeaderCellDrag(_ref7) {\n      var diffLeft = _ref7.left,\n          diffTop = _ref7.top;\n\n      if (!DRAG_INFO) {\n        return;\n      }\n\n      var _DRAG_INFO5 = DRAG_INFO,\n          allowTargetChange = _DRAG_INFO5.allowTargetChange,\n          dragTarget = _DRAG_INFO5.dragTarget,\n          dragIndex = _DRAG_INFO5.dragIndex,\n          dragProxy = _DRAG_INFO5.dragProxy,\n          dragColumn = _DRAG_INFO5.dragColumn,\n          dragBoxInitialRegion = _DRAG_INFO5.dragBoxInitialRegion,\n          dragBoxOffsets = _DRAG_INFO5.dragBoxOffsets,\n          dragBoxRegion = _DRAG_INFO5.dragBoxRegion,\n          groupByRanges = _DRAG_INFO5.groupByRanges,\n          theRanges = _DRAG_INFO5.columnRanges,\n          headerRegion = _DRAG_INFO5.headerRegion,\n          scrollLeftMax = _DRAG_INFO5.scrollLeftMax,\n          initialScrollLeft = _DRAG_INFO5.initialScrollLeft,\n          validDropPositions = _DRAG_INFO5.validDropPositions;\n      dragBoxRegion.set({\n        left: dragBoxInitialRegion.left,\n        top: dragBoxInitialRegion.top,\n        bottom: dragBoxInitialRegion.bottom,\n        right: dragBoxInitialRegion.right\n      });\n      var _DRAG_INFO6 = DRAG_INFO,\n          dropTarget = _DRAG_INFO6.dropTarget;\n      var _this$props2 = this.props,\n          columnReorderScrollByAmount = _this$props2.columnReorderScrollByAmount,\n          rtl = _this$props2.rtl;\n      var scrollLeft = this.getScrollLeft();\n      var scrollDiff = scrollLeft - initialScrollLeft;\n      var initialDiffLeft = diffLeft;\n      dragBoxRegion.shift({\n        top: diffTop,\n        left: diffLeft\n      });\n      diffLeft += scrollDiff;\n      var minScrollLeft = Math.max(headerRegion.left, 0);\n      var maxScrollRight = headerRegion.right;\n      var groupToolbarNode = this.groupToolbar && this.groupToolbar.current && this.groupToolbar.current.domRef ? this.groupToolbar.current.domRef.current : null;\n\n      if (this.groupToolbar.current && allowTargetChange) {\n        var groupToolbarRegion = _region.default.from(groupToolbarNode);\n\n        if (dragBoxRegion.top + dragBoxRegion.height / 2 < groupToolbarRegion.bottom) {\n          if (dropTarget !== 'group' && dragColumn.groupBy !== false) {\n            dropTarget = DRAG_INFO.dropTarget = 'group';\n          }\n        } else {\n          if (dropTarget != 'header') {\n            dropTarget = DRAG_INFO.dropTarget = 'header';\n          }\n        }\n      }\n\n      var scrollAdjust = 0;\n      var dragProxyAdjust = 0;\n      var dragComputedLocked = this.props.visibleColumns[dragIndex].computedLocked;\n\n      if (dropTarget == 'header' || dropTarget == 'headergroup') {\n        if (dragBoxInitialRegion.left + initialDiffLeft - this.props.totalLockedStartWidth < minScrollLeft + SCROLL_MARGIN && initialDiffLeft < 0) {\n          scrollAdjust = -columnReorderScrollByAmount;\n        } else if (dragBoxInitialRegion.right + initialDiffLeft > maxScrollRight - SCROLL_MARGIN - this.props.totalLockedEndWidth && initialDiffLeft > 0) {\n          scrollAdjust = columnReorderScrollByAmount;\n        }\n\n        if (scrollAdjust) {\n          if (scrollLeft + scrollAdjust < 0) {\n            scrollAdjust = -scrollLeft;\n          }\n\n          if (scrollLeft + scrollAdjust > scrollLeftMax) {\n            scrollAdjust = scrollLeftMax - scrollLeft;\n          }\n\n          if (scrollAdjust) {\n            this.setScrollLeft(scrollLeft + scrollAdjust);\n            dragProxyAdjust = scrollAdjust;\n          }\n        }\n      }\n\n      if (rtl) {\n        dragProxy.setRight(dragBoxOffsets.right + -initialDiffLeft - dragBoxInitialRegion.right - dragProxyAdjust);\n      } else {\n        dragProxy.setLeft(dragBoxInitialRegion.left + initialDiffLeft - dragBoxOffsets.left - dragProxyAdjust);\n      }\n\n      dragProxy.setTop(dragBoxRegion.top - dragBoxOffsets.top);\n      var dir = dropTarget == 'group' && dragTarget == 'group' ? initialDiffLeft < 0 ? -1 : 1 : dragTarget != dropTarget || diffLeft < 0 ? -1 : 1;\n\n      if (dragComputedLocked) {\n        dir = initialDiffLeft < 0 ? -1 : 1;\n      }\n\n      if (rtl) {\n        dir *= -1;\n      }\n\n      var mapRange = function mapRange(r) {\n        if (!r.computedLocked) {\n          return _objectSpread(_objectSpread({}, r), {}, {\n            left: r.left - scrollDiff,\n            right: r.right - scrollDiff\n          });\n        }\n\n        return r;\n      };\n\n      var currentRanges = dropTarget === 'group' ? groupByRanges : theRanges;\n      var ranges = currentRanges.map(mapRange);\n      var compareRanges = currentRanges.map(mapRange);\n      var dragMinIndex = dropTarget == 'header' ? DRAG_INFO.minHeaderIndex : undefined;\n      var dragMaxIndex = dropTarget == 'header' ? DRAG_INFO.maxHeaderIndex : undefined;\n      var dropIndex;\n\n      var _getDropIndex = (0, _getDropIndex2.default)({\n        dir: dir,\n        rtl: rtl,\n        dragMinIndex: dragMinIndex,\n        dragMaxIndex: dragMaxIndex,\n        dragTarget: dragTarget,\n        dropTarget: dropTarget,\n        dragRange: _objectSpread(_objectSpread({}, ranges[dragIndex]), {}, {\n          left: dragBoxRegion.left,\n          right: dragBoxRegion.right,\n          index: dragIndex\n        }),\n        dragIndex: dragIndex,\n        ranges: compareRanges,\n        validDropPositions: dropTarget === dragTarget ? validDropPositions : undefined\n      }),\n          newDropIndex = _getDropIndex.index,\n          locked = _getDropIndex.locked;\n\n      DRAG_INFO.newLocked = locked;\n\n      if (newDropIndex != undefined) {\n        dropIndex = newDropIndex;\n      }\n\n      var offset = 0;\n      var visible;\n\n      if (locked === 'start' && newDropIndex === this.props.firstUnlockedIndex) {\n        offset = (rtl ? -1 : 1) * -11;\n      }\n\n      if (newDropIndex === this.props.firstLockedEndIndex && dragIndex !== this.props.firstLockedEndIndex) {\n        if (locked === 'end') {\n          offset = (rtl ? -1 : 1) * 4;\n        } else if (!locked) {\n          offset = (rtl ? -1 : 1) * -6;\n        }\n      }\n\n      if (newDropIndex === this.props.visibleColumns.length) {\n        offset = rtl ? 6 : -6;\n      }\n\n      if (locked == null && dragComputedLocked === 'end' && newDropIndex === this.props.firstLockedEndIndex) {\n        visible = true;\n      }\n\n      this.dropIndex = dropIndex;\n      this.setReorderArrowVisible(true);\n      this.setReorderArrowPosition(undefined, dropTarget);\n      this.setReorderArrowAt(dropIndex, compareRanges, dropTarget, offset, visible);\n    }\n  }, {\n    key: \"setColumnOrder\",\n    value: function setColumnOrder(newColumnOrder) {\n      var columnOrder = getColumnOrder(this.props);\n\n      if (this.props.setColumnOrder && JSON.stringify(columnOrder) !== JSON.stringify(newColumnOrder)) {\n        this.props.setColumnOrder(newColumnOrder);\n      }\n    }\n  }, {\n    key: \"setGroupBy\",\n    value: function setGroupBy(groupBy) {\n      if (this.props.onGroupByChange && JSON.stringify(groupBy) !== JSON.stringify(this.props.computedGroupBy)) {\n        this.props.onGroupByChange(groupBy);\n      }\n    }\n  }, {\n    key: \"insertGroupBy\",\n    value: function insertGroupBy(at, column) {\n      var props = this.props;\n      var order = (0, _toConsumableArray2.default)(props.computedGroupBy);\n      order.splice(at, 0, column.id);\n      this.setGroupBy(order);\n    }\n  }]);\n  return InovuaDataGridHeaderLayout;\n}(_reactClass.default);\n\nexports.default = InovuaDataGridHeaderLayout;\nInovuaDataGridHeaderLayout.propTypes = {\n  i18n: _propTypes.default.func.isRequired,\n  renderGroupToolbar: _propTypes.default.func,\n  renderDragGroupItem: _propTypes.default.func,\n  getScrollLeftMax: _propTypes.default.func.isRequired,\n  setScrollLeft: _propTypes.default.func.isRequired\n};","map":{"version":3,"sources":["/Users/kathiavargas/node_modules/@inovua/reactdatagrid-community/Layout/ColumnLayout/HeaderLayout/index.js"],"names":["_interopRequireWildcard","require","_interopRequireDefault","Object","defineProperty","exports","value","default","_defineProperty2","_extends2","_classCallCheck2","_createClass2","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","_toConsumableArray2","_react","_propTypes","_reactClass","_debounce","_contains","_assignDefined2","_region","_isMobile","_getRangesForBoxes","_getRangesForColumns","_setupColumnDrag","_moveXBeforeY","_isFocusable","_getDropIndex2","_getUndraggableSuccessiveCount","_DragCell","_DragHeaderGroup","_HeaderWrapper","_Header","_getScrollbarWidth","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","sham","Proxy","Date","prototype","toString","call","e","SCROLL_MARGIN","DRAG_INFO","preventDefault","getColumnOrder","props","doFilter","c","groupColumn","order","computedColumnOrder","map","id","columnsMap","allColumns","toId","lockedStart","lockedStartColumns","lockedMap","reduce","acc","cId","lockedEnd","lockedEndColumns","concat","getParentsForColumns","columns","groups","maxDepth","parentsForColumns","col","getParentGroups","group","includeSelf","g","name","splice","getValidDropPositions","_ref","dragTargetDepth","dragTargetIndex","dragTargetLength","allowGroupSplitOnReorder","getGroupsForColumn","parents","initialName","shouldCheck","getGroupStartFor","depth","index","initialParent","slice","itParents","currentParent","getGroupEndFor","res","dragTargetParentGroups","x","isSingleColumn","usedDepth","parentGroupStartIndex","parentGroupEndIndex","currentGroupEndIndex","_i","itGroupStartIndex","itGroupEndIndex","groupEndIsLastUnlocked","computedLocked","ReorderArrow","_React$Component","_super","_this","state","visible","bottom","top","left","set","_ref2","right","setState","setVisible","render","size","_this$state","createElement","ref","refReorderArrow","style","position","width","height","pointerEvents","opacity","display","className","rtl","renderReorderIndicator","Component","defaultProps","InovuaDataGridHeaderLayout","_Component","_super2","_this2","draggingProps","refDragGroupItem","item","dragGroupItem","refDragCell","cell","dragCell","refDragHeaderGroup","dragHeaderGroup","groupToolbar","createRef","refHeader","h","headerNode","getDOMNode","addEventListener","removeEventListener","header","headerWrapper","cmp","reorderArrow","headerDomNode","lazyNotifyHeaderScrollLeftMax","notifyHeaderScrollLeftMax","scrollLeftMax","notifyScrollLeftMax","undefined","getScrollLeftMax","onContainerScrollHorizontal","scrollLeft","setScrollLeft","getScrollLeft","setColumnRenderStartIndex","columnRenderStartIndex","renderGroupToolbar","renderHeaderWrapper","renderDragCell","renderDragGroupItem","renderDragHeaderGroup","_this$props","onGroupByChange","onHeaderSortClick","renderGroupItem","renderSortTool","groupBy","computedGroupBy","i18n","theme","headerGroupPlaceholderText","onItemMouseDown","onGroupItemMouseDown","onSortClick","computedShowHeader","onHeaderGroupMouseDown","onHeaderCellMouseDown","onHeaderCellTouchStart","computedGroups","column","event","dragTarget","dragIndex","getCellDOMNodeAt","getHeader","headerGroupProps","headerGroup","stopPropagation","ctrlKey","metaKey","_dragIndex","draggable","dragTargetNode","domRef","current","shouldStop","querySelectorAll","filterWrapperNode","groupColumns","colId","dragBoxes","getGroupsAndCells","isHeaderGroup","indexOf","computedVisibleIndex","visibleColumns","computedGroupsMap","computedGroupsDepth","maybeDragMouseDown","allowTargetChange","ranges","_ref3","visibleIndex","_ref4","_ref4$dragTarget","reorderColumns","nativeEvent","which","dragColumn","computedDepth","_ref5","_this3","computedPivot","_removeListeners","mouseMoveEventCount","didSetupDrag","cleanup","onMouseUp","onMouseMove","setupDrag","mouseup","mousemove","removeListeners","global","setTimeout","reorderProxySize","setReorderArrowAt","offset","last","box","_DRAG_INFO","headerRegion","initialScrollLeft","_box","lastBox","boxPos","nativeScroll","scrollbars","vertical","setReorderArrowPosition","pos","reorderArrowPosition","reorderProxyPosition","setReorderArrowVisible","getGroupToolbar","getGroupByItems","getSortedItemsInfo","getHeaderCells","getCells","getBoxesFor","getDragBoxInstance","dragBox","cellProps","getProps","parent","_ref6","_DRAG_INFO2","_ref6$allowTargetChan","from","dragBoxProps","rtlOffset","Math","max","totalComputedWidth","columnRanges","initialOffset","availableWidth","min","totalLockedEndWidth","groupByRanges","dragProxy","headerDragColumn","columnId","dragBoxNode","dragBoxInitialRegion","getProxyRegion","MAX_WIDTH","getWidth","setWidth","shift","pageX","columnReorderScrollByAmount","dragBoxOffsets","setProps","dragProxyPosition","setHeight","setTop","setRight","setLeft","maxHeaderIndex","reverse","minHeaderIndex","validDropPositions","wrapperNode","filterRowHeight","computedFilterable","querySelector","offsetHeight","dragColumnsIds","dragBoxRegion","clone","dragProxyInitialPosition","dropTarget","groupToolbarNode","headerGroupTargetNode","groupTargetNode","groupComputedStyle","getComputedStyle","parseInt","paddingTop","paddingBottom","headergroup","setDragging","coverHandleRef","setActive","setCursor","constrainTo","constrainReorder","parentNode","region","onDrag","onHeaderCellDrag","onDrop","onHeaderCellDrop","dropIndex","_DRAG_INFO3","newLocked","_DRAG_INFO4","currentLocked","moveColumnsBeforeIndex","setGroupBy","groupByColumn","newGroupBy","ungroupColumnToIndex","columnAtDropIndex","insertIndex","columnAtDropIndexOrLast","setColumnLocked","setColumnOrder","columnsIds","_this4","columnVisibilityMap","columnOrder","dragColumnsIndexesInAllColumns","dropBeforeIndexInAllColumns","firstDragIndex","columnRightBefore","targetColumn","newColumnOrder","_ref7","diffLeft","diffTop","_DRAG_INFO5","theRanges","_DRAG_INFO6","_this$props2","scrollDiff","initialDiffLeft","minScrollLeft","maxScrollRight","groupToolbarRegion","scrollAdjust","dragProxyAdjust","dragComputedLocked","totalLockedStartWidth","dir","mapRange","r","currentRanges","compareRanges","dragMinIndex","dragMaxIndex","_getDropIndex","dragRange","newDropIndex","locked","firstUnlockedIndex","firstLockedEndIndex","JSON","stringify","insertGroupBy","at","propTypes","func","isRequired"],"mappings":"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","sourcesContent":["/** \n * Copyright (c) INOVUA SOFTWARE TECHNOLOGIES.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactClass = _interopRequireDefault(require(\"../../../packages/react-class\"));\n\nvar _debounce = _interopRequireDefault(require(\"../../../packages/debounce\"));\n\nvar _contains = _interopRequireDefault(require(\"../../../packages/contains\"));\n\nvar _assignDefined2 = _interopRequireDefault(require(\"../../../packages/assign-defined\"));\n\nvar _region = _interopRequireDefault(require(\"../../../packages/region\"));\n\nvar _isMobile = _interopRequireDefault(require(\"../../../packages/isMobile\"));\n\nvar _getRangesForBoxes = _interopRequireDefault(require(\"./getRangesForBoxes\"));\n\nvar _getRangesForColumns = _interopRequireDefault(require(\"./getRangesForColumns\"));\n\nvar _setupColumnDrag = _interopRequireDefault(require(\"./setupColumnDrag\"));\n\nvar _moveXBeforeY = _interopRequireDefault(require(\"../../../utils/moveXBeforeY\"));\n\nvar _isFocusable = _interopRequireDefault(require(\"../../../utils/isFocusable\"));\n\nvar _getDropIndex2 = _interopRequireDefault(require(\"./getDropIndex\"));\n\nvar _getUndraggableSuccessiveCount = _interopRequireDefault(require(\"./getUndraggableSuccessiveCount\"));\n\nvar _DragCell = _interopRequireWildcard(require(\"./DragCell\"));\n\nvar _DragHeaderGroup = _interopRequireDefault(require(\"./DragHeaderGroup\"));\n\nvar _HeaderWrapper = _interopRequireDefault(require(\"./HeaderWrapper\"));\n\nvar _Header = require(\"./Header\");\n\nvar _getScrollbarWidth = _interopRequireDefault(require(\"../../../packages/getScrollbarWidth\"));\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar SCROLL_MARGIN = 40;\nvar DRAG_INFO = null;\n\nvar preventDefault = function preventDefault(e) {\n  return e.preventDefault();\n};\n\nvar getColumnOrder = function getColumnOrder(props, filter) {\n  var doFilter = function doFilter(c) {\n    return !c.groupColumn && filter ? filter(c) : true;\n  };\n\n  var order;\n\n  if (props.computedColumnOrder) {\n    order = props.computedColumnOrder.map(function (id) {\n      return props.columnsMap[id];\n    });\n  } else {\n    order = props.allColumns;\n  }\n\n  var toId = function toId(c) {\n    return c.id;\n  };\n\n  order = (order || []).filter(doFilter).map(toId);\n  var lockedStart = props.lockedStartColumns.filter(doFilter).map(toId);\n  var lockedMap = lockedStart.reduce(function (acc, cId) {\n    acc[cId] = true;\n    return acc;\n  }, {});\n  var lockedEnd = props.lockedEndColumns.filter(doFilter).map(toId);\n  lockedEnd.reduce(function (acc, cId) {\n    acc[cId] = true;\n    return acc;\n  }, lockedMap);\n  return [].concat((0, _toConsumableArray2.default)(lockedStart), (0, _toConsumableArray2.default)(order.filter(function (cId) {\n    return !lockedMap[cId];\n  })), (0, _toConsumableArray2.default)(lockedEnd));\n};\n\nvar getParentsForColumns = function getParentsForColumns(columns, groups, maxDepth) {\n  var parentsForColumns = columns.map(function (col) {\n    var result = [col.id].concat((0, _toConsumableArray2.default)((0, _Header.getParentGroups)(col.group, groups, {\n      includeSelf: true\n    }).map(function (g) {\n      return g.name;\n    })));\n\n    while (result.length <= maxDepth + 1) {\n      result.splice(0, 0, result[0]);\n    }\n\n    return result;\n  });\n  return parentsForColumns;\n};\n\nvar getValidDropPositions = function getValidDropPositions(_ref) {\n  var dragTargetDepth = _ref.dragTargetDepth,\n      dragTargetIndex = _ref.dragTargetIndex,\n      dragTargetLength = _ref.dragTargetLength,\n      parentsForColumns = _ref.parentsForColumns,\n      columns = _ref.columns,\n      allowGroupSplitOnReorder = _ref.allowGroupSplitOnReorder;\n\n  var getGroupsForColumn = function getGroupsForColumn(parents) {\n    parents = parents || [];\n    var initialName = parents[0];\n    var shouldCheck = true;\n    var groups = [];\n    parents.forEach(function (group) {\n      if (!shouldCheck) {\n        groups.push(group);\n        return;\n      }\n\n      if (shouldCheck && group !== initialName) {\n        shouldCheck = false;\n        groups.push(group);\n        return;\n      }\n\n      groups.push(null);\n    });\n    return groups;\n  };\n\n  var getGroupStartFor = function getGroupStartFor(parents, depth, index) {\n    var initialParent = parents[index].slice(-depth - 1)[0];\n    var itParents;\n    var currentParent;\n\n    do {\n      itParents = parents[index - 1];\n\n      if (!itParents) {\n        break;\n      }\n\n      currentParent = itParents.slice(-depth - 1)[0];\n\n      if (currentParent !== initialParent) {\n        break;\n      }\n\n      index--;\n    } while (index >= 0);\n\n    return index;\n  };\n\n  var getGroupEndFor = function getGroupEndFor(parents, depth, index) {\n    var initialParent = parents[index].slice(-depth - 1)[0];\n    var itParents;\n    var currentParent;\n\n    do {\n      index++;\n      itParents = parents[index];\n\n      if (!itParents) {\n        break;\n      }\n\n      currentParent = itParents.slice(-depth - 1)[0];\n\n      if (currentParent !== initialParent) {\n        break;\n      }\n    } while (index < parents.length);\n\n    return index;\n  };\n\n  var res = columns.reduce(function (acc, col, index) {\n    if (index > dragTargetIndex && index <= dragTargetIndex + dragTargetLength) {\n      return acc;\n    }\n\n    acc[index] = true;\n    return acc;\n  }, {});\n  res[columns.length] = true;\n\n  if (!allowGroupSplitOnReorder) {\n    var dragTargetParentGroups = getGroupsForColumn(parentsForColumns[dragTargetIndex]).filter(function (x) {\n      return x;\n    });\n    var isSingleColumn = !dragTargetParentGroups.length;\n    var usedDepth = isSingleColumn ? 0 : dragTargetDepth;\n    var parentGroupStartIndex = !usedDepth ? 0 : getGroupStartFor(parentsForColumns, usedDepth - 1, dragTargetIndex);\n    var parentGroupEndIndex = !usedDepth ? columns.length : getGroupEndFor(parentsForColumns, usedDepth - 1, dragTargetIndex);\n    var currentGroupEndIndex = getGroupEndFor(parentsForColumns, usedDepth, dragTargetIndex);\n\n    for (var i = 0; i <= columns.length; i++) {\n      delete res[i];\n    }\n\n    for (var _i = parentGroupStartIndex; _i < parentGroupEndIndex; _i++) {\n      var itGroupStartIndex = getGroupStartFor(parentsForColumns, usedDepth, _i);\n      var itGroupEndIndex = getGroupEndFor(parentsForColumns, usedDepth, _i);\n      res[itGroupStartIndex] = true;\n      res[itGroupEndIndex] = true;\n    }\n\n    var groupEndIsLastUnlocked = columns[currentGroupEndIndex] && columns[currentGroupEndIndex].computedLocked === 'end' && columns[currentGroupEndIndex - 1] && columns[currentGroupEndIndex - 1].computedLocked !== 'end';\n\n    if (!groupEndIsLastUnlocked) {\n      delete res[currentGroupEndIndex];\n    }\n  }\n\n  return res;\n};\n\nvar ReorderArrow = function (_React$Component) {\n  (0, _inherits2.default)(ReorderArrow, _React$Component);\n\n  var _super = _createSuper(ReorderArrow);\n\n  function ReorderArrow(props) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, ReorderArrow);\n    _this = _super.call(this, props);\n    _this.state = {\n      visible: false,\n      bottom: 0,\n      top: 0,\n      left: 0\n    };\n    return _this;\n  }\n\n  (0, _createClass2.default)(ReorderArrow, [{\n    key: \"set\",\n    value: function set(_ref2) {\n      var bottom = _ref2.bottom,\n          top = _ref2.top,\n          left = _ref2.left,\n          right = _ref2.right,\n          target = _ref2.target;\n      this.setState({\n        target: target,\n        bottom: bottom,\n        left: left,\n        top: top,\n        right: right\n      });\n    }\n  }, {\n    key: \"setVisible\",\n    value: function setVisible(visible) {\n      if (visible != this.state.visible) {\n        this.setState({\n          visible: visible\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var size = this.props.size;\n      var _this$state = this.state,\n          bottom = _this$state.bottom,\n          top = _this$state.top,\n          left = _this$state.left,\n          right = _this$state.right,\n          visible = _this$state.visible,\n          target = _this$state.target;\n      return _react.default.createElement(\"div\", {\n        ref: this.refReorderArrow,\n        style: {\n          position: 'absolute',\n          top: top,\n          left: left,\n          right: right,\n          width: size,\n          height: bottom - top,\n          bottom: bottom,\n          pointerEvents: 'none',\n          opacity: visible ? 1 : 0,\n          display: 'block'\n        },\n        className: \"InovuaReactDataGrid__column-reorder-arrow InovuaReactDataGrid__column-reorder-arrow--direction-\".concat(this.props.rtl ? 'rtl' : 'ltr')\n      }, _react.default.createElement(\"div\", {\n        className: \"InovuaReactDataGrid__column-reorder-arrow-fill InovuaReactDataGrid__column-reorder-arrow-fill--direction-\".concat(this.props.rtl ? 'rtl' : 'ltr', \" InovuaReactDataGrid__column-reorder-arrow-fill--target-\").concat(target || 'none')\n      }), this.props.renderReorderIndicator());\n    }\n  }]);\n  return ReorderArrow;\n}(_react.default.Component);\n\nReorderArrow.defaultProps = {\n  renderReorderIndicator: function renderReorderIndicator() {}\n};\n\nvar InovuaDataGridHeaderLayout = function (_Component) {\n  (0, _inherits2.default)(InovuaDataGridHeaderLayout, _Component);\n\n  var _super2 = _createSuper(InovuaDataGridHeaderLayout);\n\n  function InovuaDataGridHeaderLayout(props) {\n    var _this2;\n\n    (0, _classCallCheck2.default)(this, InovuaDataGridHeaderLayout);\n    _this2 = _super2.call(this, props);\n    _this2.state = {\n      draggingProps: null\n    };\n\n    _this2.refDragGroupItem = function (item) {\n      _this2.dragGroupItem = item;\n    };\n\n    _this2.refDragCell = function (cell) {\n      _this2.dragCell = cell;\n    };\n\n    _this2.refDragHeaderGroup = function (item) {\n      _this2.dragHeaderGroup = item;\n    };\n\n    _this2.groupToolbar = (0, _react.createRef)();\n\n    _this2.refHeader = function (h) {\n      _this2.headerNode = null;\n\n      if (h) {\n        _this2.headerNode = h.getDOMNode ? h.getDOMNode() : null;\n\n        if (!_this2.headerNode) {\n          throw 'Cannot find header node';\n        }\n\n        if (_isMobile.default) {\n          _this2.headerNode.addEventListener('touchmove', preventDefault);\n        }\n      } else {\n        if (_this2.headerNode && _isMobile.default) {\n          _this2.headerNode.removeEventListener('touchmove', preventDefault);\n        }\n\n        _this2.headerNode = null;\n      }\n\n      _this2.header = h;\n    };\n\n    _this2.headerWrapper = (0, _react.createRef)();\n\n    _this2.refReorderArrow = function (cmp) {\n      _this2.reorderArrow = cmp;\n    };\n\n    _this2.headerDomNode = (0, _react.createRef)();\n    _this2.lazyNotifyHeaderScrollLeftMax = (0, _debounce.default)(_this2.notifyHeaderScrollLeftMax, 150);\n    return _this2;\n  }\n\n  (0, _createClass2.default)(InovuaDataGridHeaderLayout, [{\n    key: \"notifyHeaderScrollLeftMax\",\n    value: function notifyHeaderScrollLeftMax(scrollLeftMax) {\n      if (this.header && this.props.lockedEndColumns) {\n        this.header.notifyScrollLeftMax(scrollLeftMax === undefined ? this.getScrollLeftMax() : scrollLeftMax);\n      }\n    }\n  }, {\n    key: \"onContainerScrollHorizontal\",\n    value: function onContainerScrollHorizontal(scrollLeft) {\n      this.scrollLeft = scrollLeft;\n\n      if (this.header) {\n        this.header.setScrollLeft(scrollLeft);\n        this.lazyNotifyHeaderScrollLeftMax();\n      }\n    }\n  }, {\n    key: \"setScrollLeft\",\n    value: function setScrollLeft(scrollLeft) {\n      this.props.setScrollLeft(scrollLeft);\n    }\n  }, {\n    key: \"getScrollLeft\",\n    value: function getScrollLeft() {\n      return this.scrollLeft || 0;\n    }\n  }, {\n    key: \"getScrollLeftMax\",\n    value: function getScrollLeftMax() {\n      return this.props.getScrollLeftMax();\n    }\n  }, {\n    key: \"setColumnRenderStartIndex\",\n    value: function setColumnRenderStartIndex(columnRenderStartIndex) {\n      if (this.header) {\n        this.header.setColumnRenderStartIndex(columnRenderStartIndex);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react.default.createElement(\"div\", {\n        ref: this.headerDomNode,\n        className: 'InovuaReactDataGrid__header-layout'\n      }, this.renderGroupToolbar(), this.renderHeaderWrapper(), this.renderDragCell(), this.renderDragGroupItem(), this.renderDragHeaderGroup(), this.renderReorderIndicator());\n    }\n  }, {\n    key: \"renderGroupToolbar\",\n    value: function renderGroupToolbar() {\n      var _this$props = this.props,\n          columnsMap = _this$props.columnsMap,\n          onGroupByChange = _this$props.onGroupByChange,\n          onHeaderSortClick = _this$props.onHeaderSortClick,\n          renderGroupItem = _this$props.renderGroupItem,\n          renderSortTool = _this$props.renderSortTool,\n          renderGroupToolbar = _this$props.renderGroupToolbar,\n          groupBy = _this$props.computedGroupBy,\n          i18n = _this$props.i18n,\n          rtl = _this$props.rtl,\n          theme = _this$props.theme;\n\n      if (!groupBy || !renderGroupToolbar) {\n        return null;\n      }\n\n      return renderGroupToolbar({\n        columnsMap: columnsMap,\n        groupBy: groupBy,\n        rtl: rtl,\n        theme: theme,\n        renderSortTool: renderSortTool,\n        onGroupByChange: onGroupByChange,\n        renderGroupItem: renderGroupItem,\n        headerGroupPlaceholderText: i18n('dragHeaderToGroup'),\n        onItemMouseDown: this.onGroupItemMouseDown,\n        onSortClick: onHeaderSortClick,\n        ref: this.groupToolbar\n      });\n    }\n  }, {\n    key: \"renderHeaderWrapper\",\n    value: function renderHeaderWrapper() {\n      var props = this.props;\n      var computedShowHeader = props.computedShowHeader;\n\n      if (!computedShowHeader) {\n        return null;\n      }\n\n      var scrollLeft = (this.scrollLeft !== undefined ? this.scrollLeft : props.scrollLeft) || 0;\n      var groupBy = this.props.computedGroupBy && this.props.computedGroupBy.length ? this.props.computedGroupBy : null;\n      return _react.default.createElement(_HeaderWrapper.default, (0, _extends2.default)({}, props, {\n        groupBy: groupBy,\n        onHeaderGroupMouseDown: this.onHeaderGroupMouseDown,\n        onHeaderCellMouseDown: this.onHeaderCellMouseDown,\n        onHeaderCellTouchStart: this.onHeaderCellTouchStart,\n        ref: this.headerWrapper,\n        refHeader: this.refHeader,\n        scrollLeft: scrollLeft\n      }));\n    }\n  }, {\n    key: \"renderDragCell\",\n    value: function renderDragCell() {\n      return _react.default.createElement(_DragCell.default, {\n        ref: this.refDragCell\n      });\n    }\n  }, {\n    key: \"renderDragGroupItem\",\n    value: function renderDragGroupItem() {\n      if (!this.props.renderDragGroupItem) {\n        return null;\n      }\n\n      return this.props.renderDragGroupItem(this.refDragGroupItem);\n    }\n  }, {\n    key: \"renderDragHeaderGroup\",\n    value: function renderDragHeaderGroup() {\n      if (!this.props.computedGroups) {\n        return;\n      }\n\n      return _react.default.createElement(_DragHeaderGroup.default, {\n        ref: this.refDragHeaderGroup\n      });\n    }\n  }, {\n    key: \"onGroupItemMouseDown\",\n    value: function onGroupItemMouseDown(column, index, event) {\n      this.onHeaderCellMouseDown(column, event, {\n        dragTarget: 'group',\n        dragIndex: index\n      });\n    }\n  }, {\n    key: \"getCellDOMNodeAt\",\n    value: function getCellDOMNodeAt(index) {\n      return this.header.getCellDOMNodeAt(index);\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader() {\n      return this.header;\n    }\n  }, {\n    key: \"onHeaderGroupMouseDown\",\n    value: function onHeaderGroupMouseDown(event, headerGroupProps, headerGroup) {\n      event.stopPropagation();\n\n      if (event.ctrlKey || event.metaKey) {\n        return;\n      }\n\n      if (this._dragIndex !== undefined) {\n        return;\n      }\n\n      if (headerGroupProps.group && headerGroupProps.group.draggable === false) {\n        return;\n      }\n\n      var dragTargetNode = headerGroup.domRef ? headerGroup.domRef.current : null;\n      var shouldStop = (0, _toConsumableArray2.default)(dragTargetNode.querySelectorAll('.InovuaReactDataGrid__column-header__filter-wrapper')).reduce(function (shouldStop, filterWrapperNode) {\n        if ((0, _contains.default)(filterWrapperNode, event.target) || filterWrapperNode === event.target) {\n          return true;\n        }\n\n        return shouldStop;\n      }, false);\n\n      if (shouldStop) {\n        return;\n      }\n\n      var groupColumns = headerGroupProps.columns.reduce(function (acc, colId) {\n        acc[colId] = true;\n        return acc;\n      }, {});\n      this.groupColumns = groupColumns;\n      var dragBoxes = this.header.getGroupsAndCells().filter(function (item) {\n        if (item === headerGroup) {\n          return true;\n        }\n\n        if (item.props.id in groupColumns) {\n          return false;\n        }\n\n        return !item.props.isHeaderGroup;\n      });\n      var dragIndex = dragBoxes.indexOf(headerGroup);\n      var dragTargetIndex = this.props.columnsMap[headerGroup.props.columns[0]].computedVisibleIndex;\n      var dragTargetDepth = headerGroup.props.depth;\n      var dragTargetLength = headerGroup.props.columns.length;\n      var parentsForColumns = getParentsForColumns(this.props.visibleColumns, this.props.computedGroupsMap, this.props.computedGroupsDepth);\n      this.maybeDragMouseDown(event, {\n        dragTarget: 'headergroup',\n        dragTargetIndex: dragTargetIndex,\n        dragTargetDepth: dragTargetDepth,\n        dragTargetLength: dragTargetLength,\n        parentsForColumns: parentsForColumns,\n        dragTargetNode: dragTargetNode,\n        dragIndex: dragIndex,\n        dragBoxes: dragBoxes,\n        allowTargetChange: false,\n        ranges: (0, _getRangesForBoxes.default)(dragBoxes, function (i) {\n          return i;\n        })\n      });\n    }\n  }, {\n    key: \"onHeaderCellTouchStart\",\n    value: function onHeaderCellTouchStart() {\n      return this.onHeaderCellMouseDown.apply(this, arguments);\n    }\n  }, {\n    key: \"onHeaderCellMouseDown\",\n    value: function onHeaderCellMouseDown(_ref3, event) {\n      var visibleIndex = _ref3.computedVisibleIndex;\n\n      var _ref4 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n        dragTarget: 'header'\n      },\n          _ref4$dragTarget = _ref4.dragTarget,\n          dragTarget = _ref4$dragTarget === void 0 ? 'header' : _ref4$dragTarget,\n          dragIndex = _ref4.dragIndex;\n\n      if (this.props.reorderColumns === false) {\n        return;\n      }\n\n      if ((0, _isFocusable.default)(event.target)) {\n        return;\n      }\n\n      if (event.nativeEvent.which == 3 || event.metaKey || event.ctrlKey) {\n        return;\n      }\n\n      if (dragIndex === undefined) {\n        dragIndex = visibleIndex;\n      }\n\n      if (event.ctrlKey || event.metaKey) {\n        return;\n      }\n\n      var allowTargetChange = undefined;\n      var dragColumn;\n      var dragTargetNode = this.getCellDOMNodeAt(visibleIndex);\n\n      if (dragTarget == 'header') {\n        dragColumn = this.props.visibleColumns[visibleIndex];\n\n        if (!dragColumn || dragColumn.groupColumn || dragColumn.draggable === false) {\n          event.stopPropagation();\n          return;\n        }\n\n        if (this.props.computedGroupBy) {\n          if (this.props.computedGroupBy.indexOf(dragColumn.id) != -1 || this.props.computedGroupBy.indexOf(dragColumn.name) != -1) {\n            allowTargetChange = false;\n          }\n        }\n\n        if (dragColumn.draggable === false) {\n          return;\n        }\n\n        if (dragColumn.groupBy === false) {\n          allowTargetChange = false;\n        }\n      }\n\n      var dragTargetIndex = dragIndex;\n      var dragTargetDepth = dragColumn && dragColumn.group && this.props.computedGroupsMap && this.props.computedGroupsMap[dragColumn.group] ? this.props.computedGroupsMap[dragColumn.group].computedDepth + 1 : this.props.computedGroupsDepth + 1;\n      var parentsForColumns = getParentsForColumns(this.props.visibleColumns, this.props.computedGroupsMap, this.props.computedGroupsDepth);\n      this.maybeDragMouseDown(event, {\n        dragTarget: dragTarget,\n        dragIndex: dragIndex,\n        dragTargetNode: dragTargetNode,\n        parentsForColumns: parentsForColumns,\n        dragTargetIndex: dragTargetIndex,\n        dragTargetDepth: dragTargetDepth,\n        dragTargetLength: 1,\n        allowTargetChange: allowTargetChange\n      });\n    }\n  }, {\n    key: \"maybeDragMouseDown\",\n    value: function maybeDragMouseDown(event, _ref5) {\n      var _this3 = this;\n\n      var dragTarget = _ref5.dragTarget,\n          dragIndex = _ref5.dragIndex,\n          allowTargetChange = _ref5.allowTargetChange,\n          ranges = _ref5.ranges,\n          parentsForColumns = _ref5.parentsForColumns,\n          dragTargetIndex = _ref5.dragTargetIndex,\n          dragTargetDepth = _ref5.dragTargetDepth,\n          dragTargetNode = _ref5.dragTargetNode,\n          dragTargetLength = _ref5.dragTargetLength;\n\n      if (this.props.computedPivot) {\n        return;\n      }\n\n      this._dragIndex = dragIndex;\n\n      var _removeListeners;\n\n      var mouseMoveEventCount = 0;\n      var didSetupDrag = false;\n\n      var cleanup = function cleanup() {\n        delete _this3._dragIndex;\n\n        if (_removeListeners) {\n          _removeListeners();\n        }\n      };\n\n      var onMouseUp = cleanup;\n\n      var onMouseMove = function onMouseMove(event) {\n        if (didSetupDrag) {\n          return;\n        }\n\n        mouseMoveEventCount++;\n\n        if (mouseMoveEventCount > 1) {\n          didSetupDrag = true;\n\n          _removeListeners();\n\n          _this3.setupDrag({\n            dragTarget: dragTarget,\n            dragIndex: dragIndex,\n            allowTargetChange: allowTargetChange,\n            ranges: ranges,\n            parentsForColumns: parentsForColumns,\n            dragTargetIndex: dragTargetIndex,\n            dragTargetDepth: dragTargetDepth,\n            dragTargetLength: dragTargetLength,\n            dragTargetNode: dragTargetNode\n          }, event);\n        }\n      };\n\n      var mouseup = _isMobile.default ? 'touchend' : 'mouseup';\n      var mousemove = _isMobile.default ? 'touchmove' : 'mousemove';\n\n      _removeListeners = function removeListeners() {\n        _removeListeners = null;\n        global.removeEventListener(mouseup, onMouseUp, false);\n        global.removeEventListener(mousemove, onMouseMove, false);\n      };\n\n      if (_isMobile.default) {\n        setTimeout(function () {\n          onMouseUp();\n        }, 350);\n      }\n\n      global.addEventListener(mouseup, onMouseUp, false);\n      global.addEventListener(mousemove, onMouseMove, false);\n    }\n  }, {\n    key: \"renderReorderIndicator\",\n    value: function renderReorderIndicator() {\n      var size = this.props.reorderProxySize;\n      return _react.default.createElement(ReorderArrow, {\n        ref: this.refReorderArrow,\n        size: size,\n        rtl: this.props.rtl,\n        renderReorderIndicator: this.props.renderReorderIndicator\n      });\n    }\n  }, {\n    key: \"setReorderArrowAt\",\n    value: function setReorderArrowAt(index, ranges, target) {\n      var offset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var visible = arguments.length > 4 ? arguments[4] : undefined;\n      visible = visible !== undefined ? visible : index != DRAG_INFO.dragIndex || target != DRAG_INFO.dragTarget;\n\n      if (offset) {\n        visible = true;\n      }\n\n      var rtl = this.props.rtl;\n      this.reorderArrow.setVisible(visible);\n      var last = index == ranges.length;\n      var box = ranges[index];\n      var _DRAG_INFO = DRAG_INFO,\n          headerRegion = _DRAG_INFO.headerRegion,\n          initialScrollLeft = _DRAG_INFO.initialScrollLeft;\n\n      if (!box && last) {\n        var _box;\n\n        var lastBox = ranges[ranges.length - 1] || {\n          left: headerRegion.left,\n          right: headerRegion.left\n        };\n        box = (_box = {}, (0, _defineProperty2.default)(_box, rtl ? 'right' : 'left', rtl ? lastBox.left : lastBox.right), (0, _defineProperty2.default)(_box, \"computedLocked\", lastBox.computedLocked), _box);\n      }\n\n      box = box || (rtl ? {\n        right: 0\n      } : {\n        left: 0\n      });\n      var boxPos = rtl ? box.right : box.left;\n\n      if (rtl && this.props.nativeScroll && this.props.scrollbars.vertical) {\n        boxPos -= (0, _getScrollbarWidth.default)();\n      }\n\n      return this.setReorderArrowPosition(rtl ? -boxPos + headerRegion.right - offset : boxPos - headerRegion.left + offset, target);\n    }\n  }, {\n    key: \"setReorderArrowPosition\",\n    value: function setReorderArrowPosition(pos, target) {\n      var rtl = this.props.rtl;\n      this.reorderArrowPosition = this.reorderArrowPosition || {};\n      (0, _assignDefined2.default)(this.reorderArrowPosition, (0, _defineProperty2.default)({}, rtl ? 'right' : 'left', pos));\n      this.reorderArrow.set(_objectSpread((0, _defineProperty2.default)({\n        target: target\n      }, rtl ? 'right' : 'left', rtl ? this.reorderArrowPosition.right : this.reorderArrowPosition.left), DRAG_INFO.reorderProxyPosition[target]));\n      return this;\n    }\n  }, {\n    key: \"setReorderArrowVisible\",\n    value: function setReorderArrowVisible(visible) {\n      this.reorderArrow.setVisible(visible);\n      return this;\n    }\n  }, {\n    key: \"getGroupToolbar\",\n    value: function getGroupToolbar() {\n      return this.groupToolbar.current;\n    }\n  }, {\n    key: \"getGroupByItems\",\n    value: function getGroupByItems() {\n      if (!this.groupToolbar.current) {\n        return null;\n      }\n\n      return this.groupToolbar.current.getSortedItemsInfo();\n    }\n  }, {\n    key: \"getHeaderCells\",\n    value: function getHeaderCells() {\n      return this.header.getCells();\n    }\n  }, {\n    key: \"getBoxesFor\",\n    value: function getBoxesFor(target) {\n      if (target == 'header') {\n        return this.header.getCells();\n      }\n\n      if (target == 'group' && this.groupToolbar.current) {\n        return this.groupToolbar.current.getCells();\n      }\n\n      if (target == 'headergroup') {\n        return this.header.getGroupsAndCells();\n      }\n\n      return [];\n    }\n  }, {\n    key: \"getDragBoxInstance\",\n    value: function getDragBoxInstance(dragIndex, dragTarget, dragTargetDepth, dragTargetLength) {\n      if (dragTarget === 'group') {\n        return this.getGroupToolbar().getCells()[dragIndex];\n      }\n\n      var dragCell = this.getHeaderCells()[dragIndex];\n      var dragBox = dragCell;\n\n      if (dragTargetLength) {\n        var cellProps = dragCell.getProps();\n\n        while (cellProps.depth > dragTargetDepth) {\n          if (cellProps.parent) {\n            dragBox = cellProps.parent;\n            cellProps = dragBox.props;\n          } else {\n            break;\n          }\n        }\n      }\n\n      return dragBox;\n    }\n  }, {\n    key: \"setupDrag\",\n    value: function setupDrag(_ref6, event) {\n      var _DRAG_INFO2;\n\n      var dragTarget = _ref6.dragTarget,\n          dragIndex = _ref6.dragIndex,\n          _ref6$allowTargetChan = _ref6.allowTargetChange,\n          allowTargetChange = _ref6$allowTargetChan === void 0 ? true : _ref6$allowTargetChan,\n          parentsForColumns = _ref6.parentsForColumns,\n          dragTargetIndex = _ref6.dragTargetIndex,\n          dragTargetDepth = _ref6.dragTargetDepth,\n          dragTargetLength = _ref6.dragTargetLength;\n      var columns = this.props.visibleColumns;\n      var rtl = this.props.rtl;\n\n      var headerRegion = _region.default.from(this.headerDomNode.current);\n\n      var dragBox = this.getDragBoxInstance(dragIndex, dragTarget, dragTargetDepth, dragTargetLength);\n      var initialScrollLeft = this.getScrollLeft();\n      var dragBoxProps = dragBox.getProps ? dragBox.getProps() : dragBox.props;\n      var rtlOffset = Math.max(this.props.totalComputedWidth - this.props.size.width, 0);\n      var columnRanges = (0, _getRangesForColumns.default)(columns, {\n        rtl: rtl,\n        rtlOffset: rtlOffset,\n        initialOffset: rtl ? headerRegion.right : headerRegion.left,\n        headerRegion: headerRegion,\n        initialScrollLeft: initialScrollLeft,\n        availableWidth: Math.min(this.props.availableWidth, this.props.totalComputedWidth),\n        totalLockedEndWidth: this.props.totalLockedEndWidth\n      });\n      var groupByRanges = this.props.computedGroupBy && this.props.computedGroupBy.length ? (0, _getRangesForBoxes.default)(this.getGroupToolbar().getCells()) : [];\n      var dragProxy = dragTarget == 'header' ? this.dragCell : dragTarget == 'group' ? this.dragGroupItem : this.dragHeaderGroup;\n      var dragColumn = dragTarget === 'group' ? dragBoxProps.column : columns[dragIndex];\n      var headerDragColumn = dragTarget == 'header' ? dragColumn : null;\n      var columnId = dragTarget == 'header' ? headerDragColumn.id : dragTarget == 'group' ? dragColumn.id : null;\n      var dragBoxNode = dragBox.domRef ? dragBox.domRef.current : null;\n      var dragBoxInitialRegion = dragBox && dragBox.getProxyRegion ? dragBox.getProxyRegion() : _region.default.from(dragBoxNode);\n\n      if (_DragCell.MAX_WIDTH && dragBoxInitialRegion.getWidth() > _DragCell.MAX_WIDTH) {\n        dragBoxInitialRegion.setWidth(_DragCell.MAX_WIDTH);\n      }\n\n      if (_region.default.from(dragBoxNode).getWidth() > headerRegion.getWidth() / 2) {\n        if (rtl) {\n          dragBoxInitialRegion.shift({\n            right: event.pageX - dragBoxInitialRegion.right - this.props.columnReorderScrollByAmount\n          });\n        } else {\n          dragBoxInitialRegion.shift({\n            left: event.pageX - dragBoxInitialRegion.left - this.props.columnReorderScrollByAmount\n          });\n        }\n      }\n\n      var dragBoxOffsets = (0, _defineProperty2.default)({\n        top: headerRegion.top\n      }, rtl ? 'right' : 'left', rtl ? headerRegion.right : headerRegion.left);\n      dragProxy.setProps(dragBoxProps);\n      var dragProxyPosition = (0, _defineProperty2.default)({\n        top: dragBoxInitialRegion.top - dragBoxOffsets.top\n      }, rtl ? 'right' : 'left', rtl ? dragBoxOffsets.right - dragBoxInitialRegion.right : dragBoxInitialRegion.left - dragBoxOffsets.left);\n      dragProxy.setHeight(dragBoxInitialRegion.height);\n      dragProxy.setWidth(dragBoxInitialRegion.width);\n      dragProxy.setTop(dragProxyPosition.top);\n\n      if (rtl) {\n        dragProxy.setRight(dragProxyPosition.right);\n      } else {\n        dragProxy.setLeft(dragProxyPosition.left);\n      }\n\n      this.setReorderArrowVisible(headerDragColumn ? headerDragColumn.draggable !== false : true);\n      var maxHeaderIndex = columns.length - (0, _getUndraggableSuccessiveCount.default)((0, _toConsumableArray2.default)(columns).reverse());\n      var minHeaderIndex = (0, _getUndraggableSuccessiveCount.default)(columns);\n      var validDropPositions = columns.reduce(function (acc, col, i) {\n        acc[i] = true;\n        return acc;\n      }, {});\n      validDropPositions[columns.length] = true;\n\n      if (this.props.groups && this.props.groups.length && !this.props.allowGroupSplitOnReorder) {\n        validDropPositions = getValidDropPositions({\n          dragTargetDepth: dragTargetDepth,\n          dragTargetIndex: dragTargetIndex,\n          dragTargetLength: dragTargetLength,\n          parentsForColumns: parentsForColumns,\n          columns: columns,\n          allowGroupSplitOnReorder: this.props.allowGroupSplitOnReorder,\n          maxDepth: this.props.computedGroupsDepth + 1\n        });\n      }\n\n      if (validDropPositions && !validDropPositions[dragIndex] && dragTarget != 'group') {\n        validDropPositions[dragIndex] = true;\n      }\n\n      var wrapperNode = this.headerDomNode ? this.headerDomNode.current : null;\n      var filterRowHeight = 0;\n\n      if (this.props.computedFilterable) {\n        var filterWrapperNode = wrapperNode.querySelector('.InovuaReactDataGrid__column-header__filter-wrapper');\n\n        if (filterWrapperNode) {\n          filterRowHeight = filterWrapperNode.offsetHeight;\n        }\n      }\n\n      DRAG_INFO = (_DRAG_INFO2 = {\n        allowTargetChange: allowTargetChange,\n        columnId: columnId,\n        headerRegion: headerRegion,\n        headerDragColumn: headerDragColumn,\n        minHeaderIndex: minHeaderIndex,\n        maxHeaderIndex: maxHeaderIndex,\n        dragColumn: dragColumn,\n        dragColumnsIds: dragTarget == 'headergroup' ? dragBox.props.columns : null,\n        dragBox: dragBox,\n        dragBoxInitialRegion: dragBoxInitialRegion,\n        dragBoxRegion: dragBoxInitialRegion.clone(),\n        dragBoxProps: dragBoxProps,\n        dragBoxOffsets: dragBoxOffsets,\n        dragProxy: dragProxy,\n        dragProxyInitialPosition: dragProxyPosition,\n        dragTarget: dragTarget,\n        dropTarget: dragTarget,\n        dragIndex: dragIndex,\n        columnRanges: columnRanges,\n        groupByRanges: groupByRanges,\n        parentsForColumns: parentsForColumns,\n        dragTargetIndex: dragTargetIndex,\n        dragTargetDepth: dragTargetDepth,\n        dragTargetLength: dragTargetLength,\n        scrollLeftMax: this.props.getScrollLeftMax(),\n        initialScrollLeft: initialScrollLeft\n      }, (0, _defineProperty2.default)(_DRAG_INFO2, \"headerRegion\", headerRegion), (0, _defineProperty2.default)(_DRAG_INFO2, \"validDropPositions\", validDropPositions), _DRAG_INFO2);\n      var groupToolbarNode = this.groupToolbar.current ? this.groupToolbar.current.domRef ? this.groupToolbar.current.domRef.current : null : null;\n      var headerGroupTargetNode = wrapperNode;\n      var groupTargetNode = groupToolbarNode || this.headerDomNode.current;\n      var groupComputedStyle = getComputedStyle(groupTargetNode);\n      DRAG_INFO.reorderProxyPosition = {\n        group: {\n          top: parseInt(groupComputedStyle.paddingTop),\n          bottom: groupTargetNode.offsetHeight - parseInt(groupComputedStyle.paddingBottom)\n        },\n        header: {\n          top: this.props.computedGroupBy ? groupTargetNode.offsetHeight : 0,\n          bottom: headerGroupTargetNode.offsetHeight - filterRowHeight\n        },\n        headergroup: {\n          top: this.props.computedGroupBy ? groupTargetNode.offsetHeight : 0,\n          bottom: headerGroupTargetNode.offsetHeight - filterRowHeight\n        }\n      };\n      this.setReorderArrowAt(dragIndex, dragTarget === 'group' ? groupByRanges : columnRanges, dragTarget);\n      this.setReorderArrowPosition(undefined, dragTarget);\n      dragProxy.setDragging(true);\n      this.props.coverHandleRef.current.setActive(true);\n      this.props.coverHandleRef.current.setCursor('grabbing');\n      var headerNode = this.headerDomNode ? this.headerDomNode.current : null;\n      (0, _setupColumnDrag.default)({\n        constrainTo: this.props.constrainReorder ? _region.default.from(headerNode.parentNode) : undefined,\n        region: dragBoxInitialRegion\n      }, {\n        onDrag: this.onHeaderCellDrag,\n        onDrop: this.onHeaderCellDrop\n      }, event);\n    }\n  }, {\n    key: \"onHeaderCellDrop\",\n    value: function onHeaderCellDrop() {\n      this.props.coverHandleRef.current.setActive(false);\n      delete this._dragIndex;\n      var dropIndex = this.dropIndex,\n          props = this.props;\n\n      if (dropIndex === undefined || !DRAG_INFO) {\n        if (DRAG_INFO) {\n          DRAG_INFO.dragProxy.setDragging(false);\n        }\n\n        this.setReorderArrowVisible(false);\n        DRAG_INFO = null;\n        return;\n      }\n\n      var _DRAG_INFO3 = DRAG_INFO,\n          dragColumn = _DRAG_INFO3.dragColumn,\n          columnId = _DRAG_INFO3.columnId,\n          dragColumnsIds = _DRAG_INFO3.dragColumnsIds,\n          dragTarget = _DRAG_INFO3.dragTarget,\n          dropTarget = _DRAG_INFO3.dropTarget,\n          dragProxy = _DRAG_INFO3.dragProxy,\n          newLocked = _DRAG_INFO3.newLocked;\n      var _DRAG_INFO4 = DRAG_INFO,\n          dragIndex = _DRAG_INFO4.dragIndex;\n      DRAG_INFO = null;\n      this.setReorderArrowVisible(false);\n      dragProxy.setDragging(false);\n      var columns = this.props.visibleColumns;\n      var currentLocked = columns[dragIndex].computedLocked;\n\n      if (dropIndex == dragIndex && newLocked === currentLocked && dragTarget == dropTarget) {\n        return;\n      }\n\n      if (dragTarget == 'headergroup') {\n        if (dropIndex == dragIndex && dragTarget == dropTarget) {\n          return;\n        }\n\n        if (columns[dropIndex]) {\n          this.moveColumnsBeforeIndex(dragColumnsIds, columns[dropIndex].computedVisibleIndex, newLocked);\n        } else if (dropIndex == columns.length) {\n          var col = columns[columns.length - 1];\n\n          if (col) {\n            this.moveColumnsBeforeIndex(dragColumnsIds, col.computedVisibleIndex + 1, newLocked);\n          }\n        }\n\n        return;\n      }\n\n      var visibleColumns = props.visibleColumns,\n          groupBy = props.computedGroupBy;\n\n      if (dropTarget == dragTarget) {\n        if (dragTarget == 'group') {\n          this.setGroupBy((0, _moveXBeforeY.default)(groupBy, dragIndex, dropIndex));\n        }\n\n        if (dragTarget == 'header') {\n          this.moveColumnsBeforeIndex([columnId], dropIndex, newLocked);\n        }\n      }\n\n      if (dragTarget == 'header' && dropTarget == 'group') {\n        var groupByColumn = visibleColumns[dragIndex];\n        var newGroupBy = [].concat(groupBy);\n        newGroupBy.splice(dropIndex, 0, groupByColumn.id);\n        this.setGroupBy(newGroupBy);\n      }\n\n      if (dragTarget == 'group' && dropTarget == 'header') {\n        this.ungroupColumnToIndex(columnId, dropIndex);\n      }\n    }\n  }, {\n    key: \"ungroupColumnToIndex\",\n    value: function ungroupColumnToIndex(columnId, dropIndex) {\n      var props = this.props;\n      var allColumns = props.allColumns,\n          visibleColumns = props.visibleColumns;\n      var dragColumn = allColumns.filter(function (c) {\n        return c.id === columnId;\n      })[0];\n      var newGroupBy = [].concat(this.props.computedGroupBy).filter(function (g) {\n        return g != columnId;\n      });\n      var columnAtDropIndex = visibleColumns[dropIndex];\n\n      if (columnAtDropIndex && columnAtDropIndex.id === columnId) {\n        this.setGroupBy(newGroupBy);\n        return;\n      }\n\n      var order = getColumnOrder(props, function (c) {\n        return c.id !== columnId;\n      });\n      var insertIndex = columnAtDropIndex ? order.indexOf(columnAtDropIndex.id) : order.length;\n      order.splice(insertIndex, 0, columnId);\n      var columnAtDropIndexOrLast = columnAtDropIndex || visibleColumns[visibleColumns.length - 1];\n\n      if (columnAtDropIndexOrLast.computedLocked != dragColumn.computedLocked) {\n        this.props.setColumnLocked(columnId, columnAtDropIndexOrLast.computedLocked);\n      }\n\n      this.setGroupBy(newGroupBy);\n      this.setColumnOrder(order);\n    }\n  }, {\n    key: \"moveColumnsBeforeIndex\",\n    value: function moveColumnsBeforeIndex(columnsIds, dropIndex, newLocked) {\n      var _this4 = this;\n\n      var props = this.props;\n      var visibleColumns = props.visibleColumns,\n          columnVisibilityMap = props.columnVisibilityMap,\n          allowGroupSplitOnReorder = props.allowGroupSplitOnReorder;\n      var columnOrder = getColumnOrder(props);\n      var columns = visibleColumns.filter(function (col) {\n        return columnsIds.indexOf(col.id) != -1;\n      });\n      var dragColumnsIndexesInAllColumns = columnsIds.map(function (columnId) {\n        return columnOrder.indexOf(columnId);\n      });\n      var dropBeforeIndexInAllColumns = visibleColumns[dropIndex] ? columnOrder.indexOf(visibleColumns[dropIndex].id) : columnOrder.length;\n      var firstDragIndex = dragColumnsIndexesInAllColumns[0];\n\n      if (!allowGroupSplitOnReorder && firstDragIndex < dropBeforeIndexInAllColumns) {\n        while (true) {\n          var columnRightBefore = columnOrder[dropBeforeIndexInAllColumns - 1];\n\n          if (columnRightBefore && columnVisibilityMap[columnRightBefore] === false) {\n            dropBeforeIndexInAllColumns--;\n            continue;\n          }\n\n          break;\n        }\n      }\n\n      var targetColumn = visibleColumns[dropIndex] || visibleColumns[visibleColumns.length - 1];\n      columns.forEach(function (col) {\n        if (newLocked != col.computedLocked) {\n          _this4.props.setColumnLocked(col.id, newLocked);\n        }\n      });\n      var newColumnOrder = (0, _moveXBeforeY.default)(columnOrder, dragColumnsIndexesInAllColumns, dropBeforeIndexInAllColumns);\n      this.setColumnOrder(newColumnOrder);\n    }\n  }, {\n    key: \"onHeaderCellDrag\",\n    value: function onHeaderCellDrag(_ref7) {\n      var diffLeft = _ref7.left,\n          diffTop = _ref7.top;\n\n      if (!DRAG_INFO) {\n        return;\n      }\n\n      var _DRAG_INFO5 = DRAG_INFO,\n          allowTargetChange = _DRAG_INFO5.allowTargetChange,\n          dragTarget = _DRAG_INFO5.dragTarget,\n          dragIndex = _DRAG_INFO5.dragIndex,\n          dragProxy = _DRAG_INFO5.dragProxy,\n          dragColumn = _DRAG_INFO5.dragColumn,\n          dragBoxInitialRegion = _DRAG_INFO5.dragBoxInitialRegion,\n          dragBoxOffsets = _DRAG_INFO5.dragBoxOffsets,\n          dragBoxRegion = _DRAG_INFO5.dragBoxRegion,\n          groupByRanges = _DRAG_INFO5.groupByRanges,\n          theRanges = _DRAG_INFO5.columnRanges,\n          headerRegion = _DRAG_INFO5.headerRegion,\n          scrollLeftMax = _DRAG_INFO5.scrollLeftMax,\n          initialScrollLeft = _DRAG_INFO5.initialScrollLeft,\n          validDropPositions = _DRAG_INFO5.validDropPositions;\n      dragBoxRegion.set({\n        left: dragBoxInitialRegion.left,\n        top: dragBoxInitialRegion.top,\n        bottom: dragBoxInitialRegion.bottom,\n        right: dragBoxInitialRegion.right\n      });\n      var _DRAG_INFO6 = DRAG_INFO,\n          dropTarget = _DRAG_INFO6.dropTarget;\n      var _this$props2 = this.props,\n          columnReorderScrollByAmount = _this$props2.columnReorderScrollByAmount,\n          rtl = _this$props2.rtl;\n      var scrollLeft = this.getScrollLeft();\n      var scrollDiff = scrollLeft - initialScrollLeft;\n      var initialDiffLeft = diffLeft;\n      dragBoxRegion.shift({\n        top: diffTop,\n        left: diffLeft\n      });\n      diffLeft += scrollDiff;\n      var minScrollLeft = Math.max(headerRegion.left, 0);\n      var maxScrollRight = headerRegion.right;\n      var groupToolbarNode = this.groupToolbar && this.groupToolbar.current && this.groupToolbar.current.domRef ? this.groupToolbar.current.domRef.current : null;\n\n      if (this.groupToolbar.current && allowTargetChange) {\n        var groupToolbarRegion = _region.default.from(groupToolbarNode);\n\n        if (dragBoxRegion.top + dragBoxRegion.height / 2 < groupToolbarRegion.bottom) {\n          if (dropTarget !== 'group' && dragColumn.groupBy !== false) {\n            dropTarget = DRAG_INFO.dropTarget = 'group';\n          }\n        } else {\n          if (dropTarget != 'header') {\n            dropTarget = DRAG_INFO.dropTarget = 'header';\n          }\n        }\n      }\n\n      var scrollAdjust = 0;\n      var dragProxyAdjust = 0;\n      var dragComputedLocked = this.props.visibleColumns[dragIndex].computedLocked;\n\n      if (dropTarget == 'header' || dropTarget == 'headergroup') {\n        if (dragBoxInitialRegion.left + initialDiffLeft - this.props.totalLockedStartWidth < minScrollLeft + SCROLL_MARGIN && initialDiffLeft < 0) {\n          scrollAdjust = -columnReorderScrollByAmount;\n        } else if (dragBoxInitialRegion.right + initialDiffLeft > maxScrollRight - SCROLL_MARGIN - this.props.totalLockedEndWidth && initialDiffLeft > 0) {\n          scrollAdjust = columnReorderScrollByAmount;\n        }\n\n        if (scrollAdjust) {\n          if (scrollLeft + scrollAdjust < 0) {\n            scrollAdjust = -scrollLeft;\n          }\n\n          if (scrollLeft + scrollAdjust > scrollLeftMax) {\n            scrollAdjust = scrollLeftMax - scrollLeft;\n          }\n\n          if (scrollAdjust) {\n            this.setScrollLeft(scrollLeft + scrollAdjust);\n            dragProxyAdjust = scrollAdjust;\n          }\n        }\n      }\n\n      if (rtl) {\n        dragProxy.setRight(dragBoxOffsets.right + -initialDiffLeft - dragBoxInitialRegion.right - dragProxyAdjust);\n      } else {\n        dragProxy.setLeft(dragBoxInitialRegion.left + initialDiffLeft - dragBoxOffsets.left - dragProxyAdjust);\n      }\n\n      dragProxy.setTop(dragBoxRegion.top - dragBoxOffsets.top);\n      var dir = dropTarget == 'group' && dragTarget == 'group' ? initialDiffLeft < 0 ? -1 : 1 : dragTarget != dropTarget || diffLeft < 0 ? -1 : 1;\n\n      if (dragComputedLocked) {\n        dir = initialDiffLeft < 0 ? -1 : 1;\n      }\n\n      if (rtl) {\n        dir *= -1;\n      }\n\n      var mapRange = function mapRange(r) {\n        if (!r.computedLocked) {\n          return _objectSpread(_objectSpread({}, r), {}, {\n            left: r.left - scrollDiff,\n            right: r.right - scrollDiff\n          });\n        }\n\n        return r;\n      };\n\n      var currentRanges = dropTarget === 'group' ? groupByRanges : theRanges;\n      var ranges = currentRanges.map(mapRange);\n      var compareRanges = currentRanges.map(mapRange);\n      var dragMinIndex = dropTarget == 'header' ? DRAG_INFO.minHeaderIndex : undefined;\n      var dragMaxIndex = dropTarget == 'header' ? DRAG_INFO.maxHeaderIndex : undefined;\n      var dropIndex;\n\n      var _getDropIndex = (0, _getDropIndex2.default)({\n        dir: dir,\n        rtl: rtl,\n        dragMinIndex: dragMinIndex,\n        dragMaxIndex: dragMaxIndex,\n        dragTarget: dragTarget,\n        dropTarget: dropTarget,\n        dragRange: _objectSpread(_objectSpread({}, ranges[dragIndex]), {}, {\n          left: dragBoxRegion.left,\n          right: dragBoxRegion.right,\n          index: dragIndex\n        }),\n        dragIndex: dragIndex,\n        ranges: compareRanges,\n        validDropPositions: dropTarget === dragTarget ? validDropPositions : undefined\n      }),\n          newDropIndex = _getDropIndex.index,\n          locked = _getDropIndex.locked;\n\n      DRAG_INFO.newLocked = locked;\n\n      if (newDropIndex != undefined) {\n        dropIndex = newDropIndex;\n      }\n\n      var offset = 0;\n      var visible;\n\n      if (locked === 'start' && newDropIndex === this.props.firstUnlockedIndex) {\n        offset = (rtl ? -1 : 1) * -11;\n      }\n\n      if (newDropIndex === this.props.firstLockedEndIndex && dragIndex !== this.props.firstLockedEndIndex) {\n        if (locked === 'end') {\n          offset = (rtl ? -1 : 1) * 4;\n        } else if (!locked) {\n          offset = (rtl ? -1 : 1) * -6;\n        }\n      }\n\n      if (newDropIndex === this.props.visibleColumns.length) {\n        offset = rtl ? 6 : -6;\n      }\n\n      if (locked == null && dragComputedLocked === 'end' && newDropIndex === this.props.firstLockedEndIndex) {\n        visible = true;\n      }\n\n      this.dropIndex = dropIndex;\n      this.setReorderArrowVisible(true);\n      this.setReorderArrowPosition(undefined, dropTarget);\n      this.setReorderArrowAt(dropIndex, compareRanges, dropTarget, offset, visible);\n    }\n  }, {\n    key: \"setColumnOrder\",\n    value: function setColumnOrder(newColumnOrder) {\n      var columnOrder = getColumnOrder(this.props);\n\n      if (this.props.setColumnOrder && JSON.stringify(columnOrder) !== JSON.stringify(newColumnOrder)) {\n        this.props.setColumnOrder(newColumnOrder);\n      }\n    }\n  }, {\n    key: \"setGroupBy\",\n    value: function setGroupBy(groupBy) {\n      if (this.props.onGroupByChange && JSON.stringify(groupBy) !== JSON.stringify(this.props.computedGroupBy)) {\n        this.props.onGroupByChange(groupBy);\n      }\n    }\n  }, {\n    key: \"insertGroupBy\",\n    value: function insertGroupBy(at, column) {\n      var props = this.props;\n      var order = (0, _toConsumableArray2.default)(props.computedGroupBy);\n      order.splice(at, 0, column.id);\n      this.setGroupBy(order);\n    }\n  }]);\n  return InovuaDataGridHeaderLayout;\n}(_reactClass.default);\n\nexports.default = InovuaDataGridHeaderLayout;\nInovuaDataGridHeaderLayout.propTypes = {\n  i18n: _propTypes.default.func.isRequired,\n  renderGroupToolbar: _propTypes.default.func,\n  renderDragGroupItem: _propTypes.default.func,\n  getScrollLeftMax: _propTypes.default.func.isRequired,\n  setScrollLeft: _propTypes.default.func.isRequired\n};"]},"metadata":{},"sourceType":"script"}